{"version":3,"sources":["E:\\my\\otus\\finance_tracker\\frontend\\__tests__\\integration\\navigation.test.tsx"],"sourcesContent":["/**\r\n * Integration Tests - Navigation and State Persistence\r\n * \r\n * Tests navigation between pages and state persistence:\r\n * - State preservation during operations\r\n * - Optimistic updates and rollback\r\n * - Error handling and recovery\r\n * \r\n * Requirements: 14.6, 15.1, 15.2, 15.3, 15.4\r\n */\r\n\r\nimport React from 'react';\r\nimport { render, screen, waitFor } from '@testing-library/react';\r\nimport userEvent from '@testing-library/user-event';\r\nimport { AppProvider, useApp } from '@/contexts/AppContext';\r\nimport { transactionApi } from '@/services/api/transactions';\r\nimport { categoryApi } from '@/services/api/categories';\r\nimport { budgetApi } from '@/services/api/budgets';\r\n\r\n// Mock the API modules\r\njest.mock('@/services/api/transactions');\r\njest.mock('@/services/api/categories');\r\njest.mock('@/services/api/budgets');\r\njest.mock('@/services/api/analytics');\r\n\r\nconst mockTransactionApi = transactionApi as jest.Mocked<typeof transactionApi>;\r\nconst mockCategoryApi = categoryApi as jest.Mocked<typeof categoryApi>;\r\nconst mockBudgetApi = budgetApi as jest.Mocked<typeof budgetApi>;\r\n\r\ndescribe('Integration Tests - Navigation and State Persistence', () => {\r\n  beforeEach(() => {\r\n    jest.clearAllMocks();\r\n  });\r\n\r\n  describe('State Persistence', () => {\r\n    it('should maintain filter state during pagination', async () => {\r\n      const mockTransactions = Array.from({ length: 25 }, (_, i) => ({\r\n        id: `txn-${i}`,\r\n        type: i % 2 === 0 ? ('expense' as const) : ('income' as const),\r\n        amount: 50.00 + i,\r\n        currency: 'USD',\r\n        categoryId: 'cat-1',\r\n        description: `Transaction ${i}`,\r\n        transactionDate: '2024-01-15',\r\n        isRecurring: false,\r\n        createdAt: '2024-01-15T00:00:00Z',\r\n        updatedAt: '2024-01-15T00:00:00Z',\r\n        category: {\r\n          id: 'cat-1',\r\n          name: 'Food',\r\n          color: '#FF5733',\r\n        },\r\n      }));\r\n\r\n      mockTransactionApi.getAll.mockResolvedValue({\r\n        data: mockTransactions,\r\n        pagination: {\r\n          page: 1,\r\n          pageSize: 10,\r\n          totalPages: 3,\r\n          totalItems: 25,\r\n        },\r\n      });\r\n\r\n      function TestApp() {\r\n        const { loadTransactions, transactions } = useApp();\r\n        const [filters, setFilters] = React.useState({ type: 'expense' as const });\r\n        const [page, setPage] = React.useState(1);\r\n\r\n        React.useEffect(() => {\r\n          loadTransactions({ ...filters, page, pageSize: 10 });\r\n        }, [filters, page]);\r\n\r\n        return (\r\n          <div>\r\n            <div data-testid=\"transactions-count\">{transactions.length}</div>\r\n            <div data-testid=\"current-page\">{page}</div>\r\n            <div data-testid=\"current-filter\">{filters.type}</div>\r\n            <button onClick={() => setPage(2)}>Next Page</button>\r\n          </div>\r\n        );\r\n      }\r\n\r\n      const user = userEvent.setup();\r\n\r\n      render(\r\n        <AppProvider>\r\n          <TestApp />\r\n        </AppProvider>\r\n      );\r\n\r\n      // Wait for initial load\r\n      await waitFor(() => {\r\n        expect(screen.getByTestId('transactions-count')).toHaveTextContent('25');\r\n      });\r\n\r\n      // Verify initial state\r\n      expect(screen.getByTestId('current-page')).toHaveTextContent('1');\r\n      expect(screen.getByTestId('current-filter')).toHaveTextContent('expense');\r\n\r\n      // Navigate to next page\r\n      await user.click(screen.getByText('Next Page'));\r\n\r\n      // Verify filter is maintained\r\n      await waitFor(() => {\r\n        expect(screen.getByTestId('current-page')).toHaveTextContent('2');\r\n        expect(screen.getByTestId('current-filter')).toHaveTextContent('expense');\r\n      });\r\n\r\n      // Verify API was called with filters\r\n      expect(mockTransactionApi.getAll).toHaveBeenLastCalledWith(\r\n        expect.objectContaining({\r\n          type: 'expense',\r\n          page: 2,\r\n          pageSize: 10,\r\n        })\r\n      );\r\n    });\r\n  });\r\n\r\n  describe('Optimistic Updates and Rollback', () => {\r\n    it('should apply optimistic updates immediately', async () => {\r\n      const mockTransaction = {\r\n        id: 'txn-1',\r\n        type: 'expense' as const,\r\n        amount: 50.00,\r\n        currency: 'USD',\r\n        categoryId: 'cat-1',\r\n        description: 'Test',\r\n        transactionDate: '2024-01-15',\r\n        isRecurring: false,\r\n        createdAt: '2024-01-15T00:00:00Z',\r\n        updatedAt: '2024-01-15T00:00:00Z',\r\n      };\r\n\r\n      mockTransactionApi.create.mockResolvedValue(mockTransaction);\r\n\r\n      function TestApp() {\r\n        const { createTransaction, transactions } = useApp();\r\n\r\n        return (\r\n          <div>\r\n            <div data-testid=\"transactions-count\">{transactions.length}</div>\r\n            <button\r\n              onClick={() =>\r\n                createTransaction({\r\n                  type: 'expense',\r\n                  amount: 50.00,\r\n                  currency: 'USD',\r\n                  categoryId: 'cat-1',\r\n                  description: 'Test',\r\n                  transactionDate: '2024-01-15',\r\n                  isRecurring: false,\r\n                })\r\n              }\r\n            >\r\n              Create Transaction\r\n            </button>\r\n          </div>\r\n        );\r\n      }\r\n\r\n      const user = userEvent.setup();\r\n\r\n      render(\r\n        <AppProvider>\r\n          <TestApp />\r\n        </AppProvider>\r\n      );\r\n\r\n      // Initial state\r\n      expect(screen.getByTestId('transactions-count')).toHaveTextContent('0');\r\n\r\n      // Create transaction\r\n      await user.click(screen.getByText('Create Transaction'));\r\n\r\n      // Verify optimistic update\r\n      await waitFor(() => {\r\n        expect(screen.getByTestId('transactions-count')).toHaveTextContent('1');\r\n      });\r\n    });\r\n\r\n    it('should rollback on failure', async () => {\r\n      const mockTransaction = {\r\n        id: 'txn-1',\r\n        type: 'expense' as const,\r\n        amount: 50.00,\r\n        currency: 'USD',\r\n        categoryId: 'cat-1',\r\n        description: 'Test',\r\n        transactionDate: '2024-01-15',\r\n        isRecurring: false,\r\n        createdAt: '2024-01-15T00:00:00Z',\r\n        updatedAt: '2024-01-15T00:00:00Z',\r\n        category: {\r\n          id: 'cat-1',\r\n          name: 'Food',\r\n          color: '#FF5733',\r\n        },\r\n      };\r\n\r\n      mockTransactionApi.getAll.mockResolvedValue({\r\n        data: [mockTransaction],\r\n        pagination: {\r\n          page: 1,\r\n          pageSize: 10,\r\n          totalPages: 1,\r\n          totalItems: 1,\r\n        },\r\n      });\r\n      mockTransactionApi.delete.mockRejectedValue(new Error('Delete failed'));\r\n\r\n      function TestApp() {\r\n        const { loadTransactions, deleteTransaction, transactions, error } = useApp();\r\n\r\n        React.useEffect(() => {\r\n          loadTransactions();\r\n        }, []);\r\n\r\n        return (\r\n          <div>\r\n            <div data-testid=\"transactions-count\">{transactions.length}</div>\r\n            <div data-testid=\"error\">{error || 'none'}</div>\r\n            <button onClick={() => deleteTransaction('txn-1').catch(() => {})}>\r\n              Delete Transaction\r\n            </button>\r\n          </div>\r\n        );\r\n      }\r\n\r\n      const user = userEvent.setup();\r\n\r\n      render(\r\n        <AppProvider>\r\n          <TestApp />\r\n        </AppProvider>\r\n      );\r\n\r\n      // Wait for initial load\r\n      await waitFor(() => {\r\n        expect(screen.getByTestId('transactions-count')).toHaveTextContent('1');\r\n      });\r\n\r\n      // Attempt to delete\r\n      await user.click(screen.getByText('Delete Transaction'));\r\n\r\n      // Verify rollback after failure\r\n      await waitFor(() => {\r\n        expect(screen.getByTestId('transactions-count')).toHaveTextContent('1');\r\n        expect(screen.getByTestId('error')).toHaveTextContent('Delete failed');\r\n      });\r\n    });\r\n  });\r\n\r\n  describe('Error Handling and Recovery', () => {\r\n    it('should display error messages and allow retry', async () => {\r\n      mockTransactionApi.getAll\r\n        .mockRejectedValueOnce(new Error('Network error'))\r\n        .mockResolvedValueOnce({\r\n          data: [],\r\n          pagination: {\r\n            page: 1,\r\n            pageSize: 10,\r\n            totalPages: 0,\r\n            totalItems: 0,\r\n          },\r\n        });\r\n\r\n      function TestApp() {\r\n        const { loadTransactions, error, clearError } = useApp();\r\n\r\n        return (\r\n          <div>\r\n            <div data-testid=\"error\">{error || 'none'}</div>\r\n            <button onClick={() => loadTransactions().catch(() => {})}>\r\n              Load Transactions\r\n            </button>\r\n            <button onClick={clearError}>Clear Error</button>\r\n          </div>\r\n        );\r\n      }\r\n\r\n      const user = userEvent.setup();\r\n\r\n      render(\r\n        <AppProvider>\r\n          <TestApp />\r\n        </AppProvider>\r\n      );\r\n\r\n      // Trigger error\r\n      await user.click(screen.getByText('Load Transactions'));\r\n\r\n      // Verify error is displayed\r\n      await waitFor(() => {\r\n        expect(screen.getByTestId('error')).toHaveTextContent('Network error');\r\n      });\r\n\r\n      // Clear error\r\n      await user.click(screen.getByText('Clear Error'));\r\n\r\n      // Verify error is cleared\r\n      await waitFor(() => {\r\n        expect(screen.getByTestId('error')).toHaveTextContent('none');\r\n      });\r\n\r\n      // Retry and succeed\r\n      await user.click(screen.getByText('Load Transactions'));\r\n\r\n      // Verify success\r\n      await waitFor(() => {\r\n        expect(screen.getByTestId('error')).toHaveTextContent('none');\r\n      });\r\n    });\r\n  });\r\n\r\n  describe('Concurrent Operations', () => {\r\n    it('should handle multiple simultaneous operations correctly', async () => {\r\n      const mockCategories = [\r\n        {\r\n          id: 'cat-1',\r\n          name: 'Food',\r\n          type: 'expense' as const,\r\n          color: '#FF5733',\r\n          createdAt: '2024-01-01T00:00:00Z',\r\n          updatedAt: '2024-01-01T00:00:00Z',\r\n        },\r\n      ];\r\n\r\n      mockCategoryApi.getAll.mockResolvedValue(mockCategories);\r\n      mockTransactionApi.getAll.mockResolvedValue({\r\n        data: [],\r\n        pagination: {\r\n          page: 1,\r\n          pageSize: 10,\r\n          totalPages: 0,\r\n          totalItems: 0,\r\n        },\r\n      });\r\n      mockBudgetApi.getAll.mockResolvedValue([]);\r\n\r\n      function TestApp() {\r\n        const { loadTransactions, loadCategories, loadBudgets, loading } = useApp();\r\n        const [loaded, setLoaded] = React.useState(false);\r\n\r\n        const loadAll = async () => {\r\n          await Promise.all([\r\n            loadTransactions(),\r\n            loadCategories(),\r\n            loadBudgets(),\r\n          ]);\r\n          setLoaded(true);\r\n        };\r\n\r\n        return (\r\n          <div>\r\n            <div data-testid=\"loading\">{loading ? 'loading' : 'idle'}</div>\r\n            <div data-testid=\"loaded\">{loaded ? 'yes' : 'no'}</div>\r\n            <button onClick={loadAll}>Load All</button>\r\n          </div>\r\n        );\r\n      }\r\n\r\n      const user = userEvent.setup();\r\n\r\n      render(\r\n        <AppProvider>\r\n          <TestApp />\r\n        </AppProvider>\r\n      );\r\n\r\n      // Trigger multiple loads\r\n      await user.click(screen.getByText('Load All'));\r\n\r\n      // Verify all APIs were called\r\n      await waitFor(() => {\r\n        expect(mockTransactionApi.getAll).toHaveBeenCalled();\r\n        expect(mockCategoryApi.getAll).toHaveBeenCalled();\r\n        expect(mockBudgetApi.getAll).toHaveBeenCalled();\r\n        expect(screen.getByTestId('loaded')).toHaveTextContent('yes');\r\n      });\r\n    });\r\n  });\r\n});\r\n"],"names":["jest","mock","mockTransactionApi","transactionApi","mockCategoryApi","categoryApi","mockBudgetApi","budgetApi","describe","beforeEach","clearAllMocks","it","mockTransactions","Array","from","length","_","i","id","type","amount","currency","categoryId","description","transactionDate","isRecurring","createdAt","updatedAt","category","name","color","getAll","mockResolvedValue","data","pagination","page","pageSize","totalPages","totalItems","TestApp","loadTransactions","transactions","useApp","filters","setFilters","React","useState","setPage","useEffect","div","data-testid","button","onClick","user","userEvent","setup","render","AppProvider","waitFor","expect","screen","getByTestId","toHaveTextContent","click","getByText","toHaveBeenLastCalledWith","objectContaining","mockTransaction","create","createTransaction","delete","mockRejectedValue","Error","deleteTransaction","error","catch","mockRejectedValueOnce","mockResolvedValueOnce","clearError","mockCategories","loadCategories","loadBudgets","loading","loaded","setLoaded","loadAll","Promise","all","toHaveBeenCalled"],"mappings":"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"}