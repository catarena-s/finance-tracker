{"version":3,"names":["cov_1h1zg5smsg","actualCoverage","s","ErrorProvider","f","getErrorMessage","useError","ErrorContext","_react","createContext","undefined","children","error","setError","useState","showError","useCallback","message","retry","type","showSuccess","showWarning","showInfo","clearError","handleRetry","b","_jsxruntime","jsxs","Provider","value","className","jsx","_Toast","Toast","onClose","onClick","context","useContext","Error","response","status","data"],"sources":["E:\\my\\otus\\finance_tracker\\frontend\\src\\components\\error\\ErrorHandler.tsx"],"sourcesContent":["\"use client\";\n\nimport React, {\n  useState,\n  useCallback,\n  createContext,\n  useContext,\n  ReactNode,\n} from \"react\";\nimport { Toast } from \"@/components/ui/Toast\";\n\ninterface ErrorContextValue {\n  showError: (message: string, retry?: () => void) => void;\n  showSuccess: (message: string) => void;\n  showWarning: (message: string) => void;\n  showInfo: (message: string) => void;\n  clearError: () => void;\n}\n\nconst ErrorContext = createContext<ErrorContextValue | undefined>(undefined);\n\ninterface ErrorState {\n  message: string;\n  type: \"error\" | \"success\" | \"warning\" | \"info\";\n  retry?: () => void;\n}\n\nexport function ErrorProvider({ children }: { children: ReactNode }) {\n  const [error, setError] = useState<ErrorState | null>(null);\n\n  const showError = useCallback((message: string, retry?: () => void) => {\n    setError({ message, type: \"error\", retry });\n  }, []);\n\n  const showSuccess = useCallback((message: string) => {\n    setError({ message, type: \"success\" });\n  }, []);\n\n  const showWarning = useCallback((message: string) => {\n    setError({ message, type: \"warning\" });\n  }, []);\n\n  const showInfo = useCallback((message: string) => {\n    setError({ message, type: \"info\" });\n  }, []);\n\n  const clearError = useCallback(() => {\n    setError(null);\n  }, []);\n\n  const handleRetry = () => {\n    if (error?.retry) {\n      error.retry();\n      clearError();\n    }\n  };\n\n  return (\n    <ErrorContext.Provider\n      value={{ showError, showSuccess, showWarning, showInfo, clearError }}\n    >\n      {children}\n      {error && (\n        <div className=\"fixed top-4 right-4 z-50 flex flex-col gap-2\">\n          <Toast message={error.message} type={error.type} onClose={clearError} />\n          {error.retry && error.type === \"error\" && (\n            <button\n              onClick={handleRetry}\n              className=\"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors text-sm font-medium shadow-lg\"\n            >\n              Повторить\n            </button>\n          )}\n        </div>\n      )}\n    </ErrorContext.Provider>\n  );\n}\n\nexport function useError() {\n  const context = useContext(ErrorContext);\n  if (context === undefined) {\n    throw new Error(\"useError must be used within an ErrorProvider\");\n  }\n  return context;\n}\n\n/**\n * Преобразует ошибки API в понятные пользователю сообщения\n */\nexport function getErrorMessage(error: any): string {\n  // Сетевые ошибки\n  if (!error.response) {\n    return \"Ошибка подключения к серверу. Проверьте интернет-соединение.\";\n  }\n\n  const status = error.response?.status;\n  const message = error.response?.data?.message || error.message;\n\n  // HTTP статусы\n  switch (status) {\n    case 400:\n      return message || \"Неверные данные. Проверьте введенную информацию.\";\n    case 401:\n      return \"Требуется авторизация. Пожалуйста, войдите в систему.\";\n    case 403:\n      return \"Доступ запрещен. У вас нет прав для выполнения этого действия.\";\n    case 404:\n      return \"Запрашиваемый ресурс не найден.\";\n    case 409:\n      return message || \"Конфликт данных. Возможно, запись уже существует.\";\n    case 422:\n      return message || \"Ошибка валидации данных.\";\n    case 500:\n      return \"Внутренняя ошибка сервера. Попробуйте позже.\";\n    case 503:\n      return \"Сервис временно недоступен. Попробуйте позже.\";\n    default:\n      return message || \"Произошла неизвестная ошибка. Попробуйте еще раз.\";\n  }\n}\n"],"mappings":"AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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","ignoreList":[]}