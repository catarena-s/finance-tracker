bc01dcca9749b146b84a18f99f83bd3d
/**
 * Unit tests — getDateRange (Dashboard)
 * Проверка вычисления диапазона дат по периоду.
 */ "use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
const _dateRange = require("../../src/utils/dateRange");
describe("getDateRange", ()=>{
    beforeAll(()=>{
        // Фиксируем дату для предсказуемых тестов
        jest.useFakeTimers();
        jest.setSystemTime(new Date("2025-02-20"));
    });
    afterAll(()=>{
        jest.useRealTimers();
    });
    it("returns start and end in YYYY-MM-DD format", ()=>{
        const { start, end } = (0, _dateRange.getDateRange)("month");
        expect(start).toMatch(/^\d{4}-\d{2}-\d{2}$/);
        expect(end).toMatch(/^\d{4}-\d{2}-\d{2}$/);
    });
    it("end is today", ()=>{
        const { end } = (0, _dateRange.getDateRange)("month");
        expect(end).toBe("2025-02-20");
    });
    it("month period gives 30 days back", ()=>{
        const { start } = (0, _dateRange.getDateRange)("month");
        const startDate = new Date(start);
        const endDate = new Date("2025-02-20");
        const diffDays = Math.round((endDate.getTime() - startDate.getTime()) / (1000 * 60 * 60 * 24));
        expect(diffDays).toBe(30);
    });
    it("day period gives 7 days back (last 7 days for chart)", ()=>{
        const { start } = (0, _dateRange.getDateRange)("day");
        const startDate = new Date(start);
        const endDate = new Date("2025-02-20");
        const diffDays = Math.round((endDate.getTime() - startDate.getTime()) / (1000 * 60 * 60 * 24));
        expect(diffDays).toBe(7);
    });
    it("year period gives 365 days back", ()=>{
        const { start } = (0, _dateRange.getDateRange)("year");
        const startDate = new Date(start);
        const endDate = new Date("2025-02-20");
        const diffDays = Math.round((endDate.getTime() - startDate.getTime()) / (1000 * 60 * 60 * 24));
        expect(diffDays).toBe(365);
    });
});

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkU6XFxteVxcb3R1c1xcZmluYW5jZV90cmFja2VyXFxmcm9udGVuZFxcX190ZXN0c19fXFxkYXNoYm9hcmRcXGdldERhdGVSYW5nZS50ZXN0LnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiBVbml0IHRlc3RzIOKAlCBnZXREYXRlUmFuZ2UgKERhc2hib2FyZClcclxuICog0J/RgNC+0LLQtdGA0LrQsCDQstGL0YfQuNGB0LvQtdC90LjRjyDQtNC40LDQv9Cw0LfQvtC90LAg0LTQsNGCINC/0L4g0L/QtdGA0LjQvtC00YMuXHJcbiAqL1xyXG5pbXBvcnQgeyBnZXREYXRlUmFuZ2UgfSBmcm9tIFwiQC91dGlscy9kYXRlUmFuZ2VcIjtcclxuXHJcbmRlc2NyaWJlKFwiZ2V0RGF0ZVJhbmdlXCIsICgpID0+IHtcclxuICBiZWZvcmVBbGwoKCkgPT4ge1xyXG4gICAgLy8g0KTQuNC60YHQuNGA0YPQtdC8INC00LDRgtGDINC00LvRjyDQv9GA0LXQtNGB0LrQsNC30YPQtdC80YvRhSDRgtC10YHRgtC+0LJcclxuICAgIGplc3QudXNlRmFrZVRpbWVycygpO1xyXG4gICAgamVzdC5zZXRTeXN0ZW1UaW1lKG5ldyBEYXRlKFwiMjAyNS0wMi0yMFwiKSk7XHJcbiAgfSk7XHJcblxyXG4gIGFmdGVyQWxsKCgpID0+IHtcclxuICAgIGplc3QudXNlUmVhbFRpbWVycygpO1xyXG4gIH0pO1xyXG5cclxuICBpdChcInJldHVybnMgc3RhcnQgYW5kIGVuZCBpbiBZWVlZLU1NLUREIGZvcm1hdFwiLCAoKSA9PiB7XHJcbiAgICBjb25zdCB7IHN0YXJ0LCBlbmQgfSA9IGdldERhdGVSYW5nZShcIm1vbnRoXCIpO1xyXG4gICAgZXhwZWN0KHN0YXJ0KS50b01hdGNoKC9eXFxkezR9LVxcZHsyfS1cXGR7Mn0kLyk7XHJcbiAgICBleHBlY3QoZW5kKS50b01hdGNoKC9eXFxkezR9LVxcZHsyfS1cXGR7Mn0kLyk7XHJcbiAgfSk7XHJcblxyXG4gIGl0KFwiZW5kIGlzIHRvZGF5XCIsICgpID0+IHtcclxuICAgIGNvbnN0IHsgZW5kIH0gPSBnZXREYXRlUmFuZ2UoXCJtb250aFwiKTtcclxuICAgIGV4cGVjdChlbmQpLnRvQmUoXCIyMDI1LTAyLTIwXCIpO1xyXG4gIH0pO1xyXG5cclxuICBpdChcIm1vbnRoIHBlcmlvZCBnaXZlcyAzMCBkYXlzIGJhY2tcIiwgKCkgPT4ge1xyXG4gICAgY29uc3QgeyBzdGFydCB9ID0gZ2V0RGF0ZVJhbmdlKFwibW9udGhcIik7XHJcbiAgICBjb25zdCBzdGFydERhdGUgPSBuZXcgRGF0ZShzdGFydCk7XHJcbiAgICBjb25zdCBlbmREYXRlID0gbmV3IERhdGUoXCIyMDI1LTAyLTIwXCIpO1xyXG4gICAgY29uc3QgZGlmZkRheXMgPSBNYXRoLnJvdW5kKChlbmREYXRlLmdldFRpbWUoKSAtIHN0YXJ0RGF0ZS5nZXRUaW1lKCkpIC8gKDEwMDAgKiA2MCAqIDYwICogMjQpKTtcclxuICAgIGV4cGVjdChkaWZmRGF5cykudG9CZSgzMCk7XHJcbiAgfSk7XHJcblxyXG4gIGl0KFwiZGF5IHBlcmlvZCBnaXZlcyA3IGRheXMgYmFjayAobGFzdCA3IGRheXMgZm9yIGNoYXJ0KVwiLCAoKSA9PiB7XHJcbiAgICBjb25zdCB7IHN0YXJ0IH0gPSBnZXREYXRlUmFuZ2UoXCJkYXlcIik7XHJcbiAgICBjb25zdCBzdGFydERhdGUgPSBuZXcgRGF0ZShzdGFydCk7XHJcbiAgICBjb25zdCBlbmREYXRlID0gbmV3IERhdGUoXCIyMDI1LTAyLTIwXCIpO1xyXG4gICAgY29uc3QgZGlmZkRheXMgPSBNYXRoLnJvdW5kKChlbmREYXRlLmdldFRpbWUoKSAtIHN0YXJ0RGF0ZS5nZXRUaW1lKCkpIC8gKDEwMDAgKiA2MCAqIDYwICogMjQpKTtcclxuICAgIGV4cGVjdChkaWZmRGF5cykudG9CZSg3KTtcclxuICB9KTtcclxuXHJcbiAgaXQoXCJ5ZWFyIHBlcmlvZCBnaXZlcyAzNjUgZGF5cyBiYWNrXCIsICgpID0+IHtcclxuICAgIGNvbnN0IHsgc3RhcnQgfSA9IGdldERhdGVSYW5nZShcInllYXJcIik7XHJcbiAgICBjb25zdCBzdGFydERhdGUgPSBuZXcgRGF0ZShzdGFydCk7XHJcbiAgICBjb25zdCBlbmREYXRlID0gbmV3IERhdGUoXCIyMDI1LTAyLTIwXCIpO1xyXG4gICAgY29uc3QgZGlmZkRheXMgPSBNYXRoLnJvdW5kKChlbmREYXRlLmdldFRpbWUoKSAtIHN0YXJ0RGF0ZS5nZXRUaW1lKCkpIC8gKDEwMDAgKiA2MCAqIDYwICogMjQpKTtcclxuICAgIGV4cGVjdChkaWZmRGF5cykudG9CZSgzNjUpO1xyXG4gIH0pO1xyXG59KTtcclxuIl0sIm5hbWVzIjpbImRlc2NyaWJlIiwiYmVmb3JlQWxsIiwiamVzdCIsInVzZUZha2VUaW1lcnMiLCJzZXRTeXN0ZW1UaW1lIiwiRGF0ZSIsImFmdGVyQWxsIiwidXNlUmVhbFRpbWVycyIsIml0Iiwic3RhcnQiLCJlbmQiLCJnZXREYXRlUmFuZ2UiLCJleHBlY3QiLCJ0b01hdGNoIiwidG9CZSIsInN0YXJ0RGF0ZSIsImVuZERhdGUiLCJkaWZmRGF5cyIsIk1hdGgiLCJyb3VuZCIsImdldFRpbWUiXSwibWFwcGluZ3MiOiJBQUFBOzs7Q0FHQzs7OzsyQkFDNEI7QUFFN0JBLFNBQVMsZ0JBQWdCO0lBQ3ZCQyxVQUFVO1FBQ1IsMENBQTBDO1FBQzFDQyxLQUFLQyxhQUFhO1FBQ2xCRCxLQUFLRSxhQUFhLENBQUMsSUFBSUMsS0FBSztJQUM5QjtJQUVBQyxTQUFTO1FBQ1BKLEtBQUtLLGFBQWE7SUFDcEI7SUFFQUMsR0FBRyw4Q0FBOEM7UUFDL0MsTUFBTSxFQUFFQyxLQUFLLEVBQUVDLEdBQUcsRUFBRSxHQUFHQyxJQUFBQSx1QkFBWSxFQUFDO1FBQ3BDQyxPQUFPSCxPQUFPSSxPQUFPLENBQUM7UUFDdEJELE9BQU9GLEtBQUtHLE9BQU8sQ0FBQztJQUN0QjtJQUVBTCxHQUFHLGdCQUFnQjtRQUNqQixNQUFNLEVBQUVFLEdBQUcsRUFBRSxHQUFHQyxJQUFBQSx1QkFBWSxFQUFDO1FBQzdCQyxPQUFPRixLQUFLSSxJQUFJLENBQUM7SUFDbkI7SUFFQU4sR0FBRyxtQ0FBbUM7UUFDcEMsTUFBTSxFQUFFQyxLQUFLLEVBQUUsR0FBR0UsSUFBQUEsdUJBQVksRUFBQztRQUMvQixNQUFNSSxZQUFZLElBQUlWLEtBQUtJO1FBQzNCLE1BQU1PLFVBQVUsSUFBSVgsS0FBSztRQUN6QixNQUFNWSxXQUFXQyxLQUFLQyxLQUFLLENBQUMsQUFBQ0gsQ0FBQUEsUUFBUUksT0FBTyxLQUFLTCxVQUFVSyxPQUFPLEVBQUMsSUFBTSxDQUFBLE9BQU8sS0FBSyxLQUFLLEVBQUM7UUFDM0ZSLE9BQU9LLFVBQVVILElBQUksQ0FBQztJQUN4QjtJQUVBTixHQUFHLHdEQUF3RDtRQUN6RCxNQUFNLEVBQUVDLEtBQUssRUFBRSxHQUFHRSxJQUFBQSx1QkFBWSxFQUFDO1FBQy9CLE1BQU1JLFlBQVksSUFBSVYsS0FBS0k7UUFDM0IsTUFBTU8sVUFBVSxJQUFJWCxLQUFLO1FBQ3pCLE1BQU1ZLFdBQVdDLEtBQUtDLEtBQUssQ0FBQyxBQUFDSCxDQUFBQSxRQUFRSSxPQUFPLEtBQUtMLFVBQVVLLE9BQU8sRUFBQyxJQUFNLENBQUEsT0FBTyxLQUFLLEtBQUssRUFBQztRQUMzRlIsT0FBT0ssVUFBVUgsSUFBSSxDQUFDO0lBQ3hCO0lBRUFOLEdBQUcsbUNBQW1DO1FBQ3BDLE1BQU0sRUFBRUMsS0FBSyxFQUFFLEdBQUdFLElBQUFBLHVCQUFZLEVBQUM7UUFDL0IsTUFBTUksWUFBWSxJQUFJVixLQUFLSTtRQUMzQixNQUFNTyxVQUFVLElBQUlYLEtBQUs7UUFDekIsTUFBTVksV0FBV0MsS0FBS0MsS0FBSyxDQUFDLEFBQUNILENBQUFBLFFBQVFJLE9BQU8sS0FBS0wsVUFBVUssT0FBTyxFQUFDLElBQU0sQ0FBQSxPQUFPLEtBQUssS0FBSyxFQUFDO1FBQzNGUixPQUFPSyxVQUFVSCxJQUFJLENBQUM7SUFDeEI7QUFDRiJ9