{"version":3,"names":["CSVExportDialog","COLUMNS","cov_2ee7e68k36","s","id","label","DATE_FORMATS","value","isOpen","onClose","categories","b","f","startDate","setStartDate","_react","useState","endDate","setEndDate","categoryId","setCategoryId","selectedColumns","setSelectedColumns","map","c","dateFormat","setDateFormat","toggleColumn","prev","includes","filter","handleDownload","url","_csv","csvApi","getExportUrl","undefined","columns","length","window","open","_jsxruntime","jsx","_ui","Modal","title","size","jsxs","className","type","onChange","e","target","name","checked","Button","variant","onClick"],"sources":["E:\\my\\otus\\finance_tracker\\frontend\\src\\components\\csv\\CSVExportDialog.tsx"],"sourcesContent":["\"use client\";\n\nimport React, { useState } from \"react\";\nimport { Modal, Button } from \"@/components/ui\";\nimport { csvApi } from \"@/services/api/csv\";\nimport type { Category } from \"@/types/api\";\n\nconst COLUMNS = [\n  { id: \"amount\", label: \"Сумма\" },\n  { id: \"currency\", label: \"Валюта\" },\n  { id: \"category_name\", label: \"Категория\" },\n  { id: \"description\", label: \"Описание\" },\n  { id: \"transaction_date\", label: \"Дата\" },\n  { id: \"type\", label: \"Тип\" },\n];\n\nconst DATE_FORMATS = [\n  { value: \"%Y-%m-%d\", label: \"YYYY-MM-DD\" },\n  { value: \"%d.%m.%Y\", label: \"DD.MM.YYYY\" },\n  { value: \"%m/%d/%Y\", label: \"MM/DD/YYYY\" },\n];\n\ninterface CSVExportDialogProps {\n  isOpen: boolean;\n  onClose: () => void;\n  categories?: Category[];\n}\n\nexport function CSVExportDialog({\n  isOpen,\n  onClose,\n  categories = [],\n}: CSVExportDialogProps) {\n  const [startDate, setStartDate] = useState<string>(\"\");\n  const [endDate, setEndDate] = useState<string>(\"\");\n  const [categoryId, setCategoryId] = useState<string>(\"\");\n  const [selectedColumns, setSelectedColumns] = useState<string[]>(\n    COLUMNS.map((c) => c.id)\n  );\n  const [dateFormat, setDateFormat] = useState(\"%Y-%m-%d\");\n\n  const toggleColumn = (id: string) => {\n    setSelectedColumns((prev) =>\n      prev.includes(id) ? prev.filter((c) => c !== id) : [...prev, id]\n    );\n  };\n\n  const handleDownload = () => {\n    const url = csvApi.getExportUrl({\n      startDate: startDate || undefined,\n      endDate: endDate || undefined,\n      categoryId: categoryId || undefined,\n      columns: selectedColumns.length ? selectedColumns : undefined,\n      dateFormat,\n    });\n    window.open(url, \"_blank\", \"noopener,noreferrer\");\n    onClose();\n  };\n\n  return (\n    <Modal isOpen={isOpen} onClose={onClose} title=\"Экспорт в CSV\" size=\"lg\">\n      <div className=\"space-y-4\">\n        <div className=\"grid grid-cols-2 gap-3\">\n          <div>\n            <label className=\"block text-sm font-medium text-foreground mb-1\">\n              Дата с\n            </label>\n            <input\n              type=\"date\"\n              className=\"w-full border border-border bg-input text-foreground rounded px-2 py-1.5 text-sm\"\n              value={startDate}\n              onChange={(e) => setStartDate(e.target.value)}\n            />\n          </div>\n          <div>\n            <label className=\"block text-sm font-medium text-foreground mb-1\">\n              Дата по\n            </label>\n            <input\n              type=\"date\"\n              className=\"w-full border border-border bg-input text-foreground rounded px-2 py-1.5 text-sm\"\n              value={endDate}\n              onChange={(e) => setEndDate(e.target.value)}\n            />\n          </div>\n        </div>\n        <div>\n          <label className=\"block text-sm font-medium text-foreground mb-1\">\n            Категория\n          </label>\n          <select\n            className=\"w-full border border-border bg-input text-foreground rounded px-2 py-1.5 text-sm\"\n            value={categoryId}\n            onChange={(e) => setCategoryId(e.target.value)}\n          >\n            <option value=\"\">Все категории</option>\n            {categories.map((c) => (\n              <option key={c.id} value={c.id}>\n                {c.name}\n              </option>\n            ))}\n          </select>\n        </div>\n        <div>\n          <label className=\"block text-sm font-medium text-foreground mb-2\">\n            Колонки\n          </label>\n          <div className=\"flex flex-wrap gap-2\">\n            {COLUMNS.map((c) => (\n              <label\n                key={c.id}\n                className=\"inline-flex items-center gap-1 cursor-pointer\"\n              >\n                <input\n                  type=\"checkbox\"\n                  checked={selectedColumns.includes(c.id)}\n                  onChange={() => toggleColumn(c.id)}\n                />\n                <span className=\"text-sm text-foreground\">{c.label}</span>\n              </label>\n            ))}\n          </div>\n        </div>\n        <div>\n          <label className=\"block text-sm font-medium text-foreground mb-1\">\n            Формат даты\n          </label>\n          <select\n            className=\"w-full border border-border bg-input text-foreground rounded px-2 py-1.5 text-sm\"\n            value={dateFormat}\n            onChange={(e) => setDateFormat(e.target.value)}\n          >\n            {DATE_FORMATS.map((f) => (\n              <option key={f.value} value={f.value}>\n                {f.label}\n              </option>\n            ))}\n          </select>\n        </div>\n        <div className=\"flex justify-end gap-2 pt-2\">\n          <Button variant=\"secondary\" onClick={onClose}>\n            Отмена\n          </Button>\n          <Button onClick={handleDownload}>Скачать CSV</Button>\n        </div>\n      </div>\n    </Modal>\n  );\n}\n"],"mappings":"AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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","ignoreList":[]}