{"version":3,"names":["CSVImportForm","toBase64","str","cov_2bbrcx7a4y","f","s","btoa","b","unescape","encodeURIComponent","Buffer","from","toString","POLL_INTERVAL_MS","MAX_POLL_ATTEMPTS","file","setFile","_react","useState","csvText","setCsvText","headers","setHeaders","rows","setRows","mappingDialogOpen","setMappingDialogOpen","mapping","setMapping","dateFormat","setDateFormat","importResult","setImportResult","importing","setImporting","taskPolling","setTaskPolling","handleFileChange","useCallback","e","target","files","reader","FileReader","onload","ev","text","result","parsed","_papaparse","default","parse","header","skipEmptyLines","hs","meta","fields","data","Object","keys","readAsText","handleMappingConfirm","m","handleImport","fileContent","_csv","csvApi","importCsv","status","taskId","attempts","poll","_tasks","tasksApi","getStatus","createdCount","created_count","errorCount","error_count","errors","row","error","setTimeout","err","message","_jsxruntime","jsxs","className","jsx","type","accept","onChange","name","length","_CSVMappingDialog","CSVMappingDialog","isOpen","onClose","initialMapping","undefined","onConfirm","Fragment","value","_CSVPreview","CSVPreview","amount","transactionDate","categoryName","_ui","Button","onClick","disabled","loading","slice","map","i"],"sources":["E:\\my\\otus\\finance_tracker\\frontend\\src\\components\\csv\\CSVImportForm.tsx"],"sourcesContent":["\"use client\";\n\nimport React, { useState, useCallback } from \"react\";\nimport Papa from \"papaparse\";\nimport { Button } from \"@/components/ui\";\nimport { csvApi } from \"@/services/api/csv\";\nimport { tasksApi } from \"@/services/api/tasks\";\nimport type { CSVColumnMapping, CSVImportResult } from \"@/types/api\";\nimport { CSVMappingDialog } from \"./CSVMappingDialog\";\nimport { CSVPreview } from \"./CSVPreview\";\n\nfunction toBase64(str: string): string {\n  return typeof btoa !== \"undefined\"\n    ? btoa(unescape(encodeURIComponent(str)))\n    : Buffer.from(str, \"utf-8\").toString(\"base64\");\n}\n\nconst POLL_INTERVAL_MS = 1500;\nconst MAX_POLL_ATTEMPTS = 120;\n\nexport function CSVImportForm() {\n  const [file, setFile] = useState<File | null>(null);\n  const [csvText, setCsvText] = useState<string>(\"\");\n  const [headers, setHeaders] = useState<string[]>([]);\n  const [rows, setRows] = useState<Record<string, string>[]>([]);\n  const [mappingDialogOpen, setMappingDialogOpen] = useState(false);\n  const [mapping, setMapping] = useState<CSVColumnMapping | null>(null);\n  const [dateFormat, setDateFormat] = useState(\"%Y-%m-%d\");\n  const [importResult, setImportResult] = useState<CSVImportResult | null>(null);\n  const [importing, setImporting] = useState(false);\n  const [taskPolling, setTaskPolling] = useState(false);\n\n  const handleFileChange = useCallback((e: React.ChangeEvent<HTMLInputElement>) => {\n    const f = e.target.files?.[0];\n    if (!f) return;\n    setFile(f);\n    setImportResult(null);\n    setMapping(null);\n    const reader = new FileReader();\n    reader.onload = (ev) => {\n      const text = (ev.target?.result as string) || (reader.result as string) || \"\";\n      setCsvText(text);\n      const parsed = Papa.parse<Record<string, string>>(text, {\n        header: true,\n        skipEmptyLines: true,\n      });\n      const hs =\n        parsed.meta.fields || (parsed.data[0] ? Object.keys(parsed.data[0]) : []);\n      setHeaders(hs);\n      setRows(parsed.data || []);\n      setMappingDialogOpen(true);\n    };\n    reader.readAsText(f, \"UTF-8\");\n  }, []);\n\n  const handleMappingConfirm = useCallback((m: CSVColumnMapping) => {\n    setMapping(m);\n    setMappingDialogOpen(false);\n  }, []);\n\n  const handleImport = useCallback(async () => {\n    if (!csvText || !mapping) return;\n    setImporting(true);\n    setImportResult(null);\n    try {\n      const fileContent = toBase64(csvText);\n      const result = await csvApi.importCsv({\n        fileContent,\n        mapping,\n        dateFormat,\n      });\n      setImportResult(result);\n\n      if (result.status === \"pending\" && result.taskId) {\n        setTaskPolling(true);\n        let attempts = 0;\n        const poll = async () => {\n          const status = await tasksApi.getStatus(result.taskId!);\n          if (status.status === \"completed\" && status.result) {\n            setImportResult({\n              taskId: result.taskId,\n              status: \"completed\",\n              createdCount:\n                (status.result as { created_count?: number }).created_count ?? 0,\n              errorCount: (status.result as { error_count?: number }).error_count ?? 0,\n              errors:\n                (status.result as { errors?: Array<{ row: number; error: string }> })\n                  .errors ?? [],\n            });\n            setTaskPolling(false);\n            return;\n          }\n          if (status.status === \"failed\") {\n            setImportResult({\n              taskId: result.taskId,\n              status: \"failed\",\n              errorCount: 1,\n              errors: [{ row: 0, error: status.error ?? \"Ошибка задачи\" }],\n            });\n            setTaskPolling(false);\n            return;\n          }\n          attempts++;\n          if (attempts < MAX_POLL_ATTEMPTS) {\n            setTimeout(poll, POLL_INTERVAL_MS);\n          } else {\n            setTaskPolling(false);\n          }\n        };\n        setTimeout(poll, POLL_INTERVAL_MS);\n      }\n    } catch (err: unknown) {\n      setImportResult({\n        taskId: \"\",\n        status: \"failed\",\n        errorCount: 1,\n        errors: [{ row: 0, error: (err as Error)?.message ?? \"Ошибка импорта\" }],\n      });\n    } finally {\n      setImporting(false);\n    }\n  }, [csvText, mapping, dateFormat]);\n\n  return (\n    <div className=\"space-y-4\">\n      <div className=\"flex flex-wrap items-center gap-3\">\n        <label className=\"cursor-pointer\">\n          <span className=\"inline-flex items-center px-4 py-2 rounded-xl border border-border bg-card text-sm font-medium text-foreground shadow-sm transition-colors duration-150 hover:bg-muted\">\n            Выбрать CSV\n          </span>\n          <input\n            type=\"file\"\n            accept=\".csv,text/csv\"\n            className=\"hidden\"\n            onChange={handleFileChange}\n          />\n        </label>\n        {file && (\n          <span className=\"text-sm text-muted-foreground\">\n            {file.name} ({rows.length} строк)\n          </span>\n        )}\n      </div>\n\n      <CSVMappingDialog\n        isOpen={mappingDialogOpen}\n        onClose={() => setMappingDialogOpen(false)}\n        headers={headers}\n        initialMapping={mapping ?? undefined}\n        onConfirm={handleMappingConfirm}\n      />\n\n      {mapping && rows.length > 0 && (\n        <>\n          <div className=\"flex items-center gap-2\">\n            <label className=\"text-sm text-muted-foreground\">Формат даты:</label>\n            <select\n              className=\"rounded-xl border border-border bg-card px-2 py-1 text-sm text-foreground shadow-sm transition-colors duration-150 focus:outline-none focus:ring-2 focus:ring-ring focus:border-primary\"\n              value={dateFormat}\n              onChange={(e) => setDateFormat(e.target.value)}\n            >\n              <option value=\"%Y-%m-%d\">YYYY-MM-DD</option>\n              <option value=\"%d.%m.%Y\">DD.MM.YYYY</option>\n              <option value=\"%m/%d/%Y\">MM/DD/YYYY</option>\n            </select>\n          </div>\n          <CSVPreview\n            rows={rows}\n            mapping={{\n              amount: mapping.amount,\n              transactionDate: mapping.transactionDate,\n              type: mapping.type,\n              categoryName: mapping.categoryName,\n            }}\n          />\n          <Button\n            onClick={handleImport}\n            disabled={importing || taskPolling}\n            loading={importing || taskPolling}\n          >\n            {taskPolling ? \"Импорт в фоне…\" : \"Импортировать\"}\n          </Button>\n        </>\n      )}\n\n      {importResult && (\n        <div\n          className={`rounded-xl border p-4 ${importResult.status === \"failed\" ? \"border-destructive/50 bg-destructive/10 text-destructive\" : \"border-secondary/50 bg-secondary/10 text-foreground\"}`}\n        >\n          <p className=\"font-medium\">\n            {importResult.status === \"completed\"\n              ? `Готово: создано ${importResult.createdCount ?? 0}, ошибок ${importResult.errorCount ?? 0}`\n              : importResult.status === \"pending\"\n                ? \"Импорт в фоне…\"\n                : \"Ошибка импорта\"}\n          </p>\n          {importResult.errors && importResult.errors.length > 0 && (\n            <ul className=\"mt-2 text-sm list-disc list-inside\">\n              {importResult.errors.slice(0, 10).map((e, i) => (\n                <li key={i}>\n                  Строка {e.row}: {e.error}\n                </li>\n              ))}\n              {(importResult.errors?.length ?? 0) > 10 && (\n                <li>… и ещё {(importResult.errors?.length ?? 0) - 10} ошибок</li>\n              )}\n            </ul>\n          )}\n        </div>\n      )}\n    </div>\n  );\n}\n"],"mappings":"AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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","ignoreList":[]}