{"version":3,"sources":["E:\\my\\otus\\finance_tracker\\frontend\\__tests__\\properties\\verticalFormFieldLayout.property.test.tsx"],"sourcesContent":["/**\r\n * Property-Based Test ‚Äî Vertical Form Field Layout\r\n * \r\n * **–°–≤–æ–π—Å—Ç–≤–æ 12: –í–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ–µ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ –ø–æ–ª–µ–π —Ñ–æ—Ä–º—ã**\r\n * **–í–∞–ª–∏–¥–∏—Ä—É–µ—Ç: –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è 4.3**\r\n * \r\n * For any form in a modal window, when viewport width is less than 640px,\r\n * form fields should be arranged vertically in a single column.\r\n * \r\n * NOTE: This test is skipped in CI due to performance. Run locally with npm test\r\n */\r\n\r\nimport React from \"react\";\r\nimport { render } from \"@testing-library/react\";\r\nimport fc from \"fast-check\";\r\nimport { Modal } from \"@/components/ui/Modal\";\r\nimport { CategoryForm } from \"@/components/categories/CategoryForm\";\r\nimport { TransactionForm } from \"@/components/transactions/TransactionForm\";\r\nimport { Category } from \"@/types/api\";\r\nimport { getNumRuns, getTimeout } from \"./property-test-config\";\r\n\r\n// Skip this test suite in CI environment\r\nconst describeOrSkip = process.env.CI === \"true\" ? describe.skip : describe;\r\n\r\n// Helper function to find elements with responsive flex layout\r\nconst findResponsiveFlexContainers = (container: HTMLElement): Element[] => {\r\n  // Look for elements with flex-col sm:flex-row pattern\r\n  const selectors = [\r\n    \".flex.flex-col.sm\\\\:flex-row\",\r\n    \"[class*='flex-col'][class*='sm:flex-row']\",\r\n  ];\r\n  \r\n  const elements: Element[] = [];\r\n  selectors.forEach((selector) => {\r\n    const found = container.querySelectorAll(selector);\r\n    found.forEach((el) => elements.push(el));\r\n  });\r\n  \r\n  return elements;\r\n};\r\n\r\n// Helper function to check if element has vertical layout classes\r\nconst hasVerticalLayout = (element: Element): boolean => {\r\n  return element.classList.contains(\"flex-col\");\r\n};\r\n\r\n// Helper function to check if element has responsive horizontal layout\r\nconst hasResponsiveHorizontalLayout = (element: Element): boolean => {\r\n  return element.className.includes(\"sm:flex-row\");\r\n};\r\n\r\n// Mock categories for testing\r\nconst mockCategories: Category[] = [\r\n  {\r\n    id: \"1\",\r\n    name: \"–ü—Ä–æ–¥—É–∫—Ç—ã\",\r\n    icon: \"üõí\",\r\n    color: \"#4CAF50\",\r\n    type: \"expense\",\r\n    createdAt: \"2024-01-01\",\r\n    updatedAt: \"2024-01-01\",\r\n  },\r\n  {\r\n    id: \"2\",\r\n    name: \"–ó–∞—Ä–ø–ª–∞—Ç–∞\",\r\n    icon: \"üí∞\",\r\n    color: \"#2196F3\",\r\n    type: \"income\",\r\n    createdAt: \"2024-01-01\",\r\n    updatedAt: \"2024-01-01\",\r\n  },\r\n];\r\n\r\ndescribeOrSkip(\"Property: Vertical Form Field Layout\", () => {\r\n  describe(\"CategoryForm in modal\", () => {\r\n    it(\"should arrange form fields vertically on mobile viewports (< 640px)\", () => {\r\n      jest.setTimeout(getTimeout(\"SLOW\"));\r\n      fc.assert(\r\n        fc.property(\r\n          fc.integer({ min: 320, max: 639 }), // Mobile viewport range\r\n          (viewportWidth) => {\r\n            // Mock window.innerWidth for mobile\r\n            Object.defineProperty(window, \"innerWidth\", {\r\n              writable: true,\r\n              configurable: true,\r\n              value: viewportWidth,\r\n            });\r\n\r\n            // Mock matchMedia for Tailwind's sm breakpoint (640px)\r\n            Object.defineProperty(window, \"matchMedia\", {\r\n              writable: true,\r\n              value: jest.fn().mockImplementation((query) => ({\r\n                matches: query.includes(\"640px\") ? false : true,\r\n                media: query,\r\n                onchange: null,\r\n                addListener: jest.fn(),\r\n                removeListener: jest.fn(),\r\n                addEventListener: jest.fn(),\r\n                removeEventListener: jest.fn(),\r\n                dispatchEvent: jest.fn(),\r\n              })),\r\n            });\r\n\r\n            const { container } = render(\r\n              <Modal isOpen={true} onClose={() => {}} title=\"–°–æ–∑–¥–∞—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é\" size=\"md\">\r\n                <CategoryForm\r\n                  onSubmit={async () => {}}\r\n                  onCancel={() => {}}\r\n                />\r\n              </Modal>\r\n            );\r\n\r\n            // Find responsive flex containers in the form\r\n            const responsiveContainers = findResponsiveFlexContainers(container);\r\n\r\n            // CategoryForm has responsive layout for color input section\r\n            expect(responsiveContainers.length).toBeGreaterThan(0);\r\n\r\n            responsiveContainers.forEach((flexContainer) => {\r\n              // On mobile (< 640px), should have vertical layout\r\n              expect(hasVerticalLayout(flexContainer)).toBe(true);\r\n              expect(hasResponsiveHorizontalLayout(flexContainer)).toBe(true);\r\n            });\r\n          }\r\n        ),\r\n        { numRuns: getNumRuns(\"SLOW\") }\r\n      );\r\n    });\r\n\r\n    it(\"should arrange form fields horizontally on desktop viewports (>= 640px)\", () => {\r\n      jest.setTimeout(getTimeout(\"SLOW\"));\r\n      fc.assert(\r\n        fc.property(\r\n          fc.integer({ min: 640, max: 1440 }), // Desktop viewport range\r\n          (viewportWidth) => {\r\n            Object.defineProperty(window, \"innerWidth\", {\r\n              writable: true,\r\n              configurable: true,\r\n              value: viewportWidth,\r\n            });\r\n\r\n            Object.defineProperty(window, \"matchMedia\", {\r\n              writable: true,\r\n              value: jest.fn().mockImplementation((query) => ({\r\n                matches: query.includes(\"640px\") ? true : false,\r\n                media: query,\r\n                onchange: null,\r\n                addListener: jest.fn(),\r\n                removeListener: jest.fn(),\r\n                addEventListener: jest.fn(),\r\n                removeEventListener: jest.fn(),\r\n                dispatchEvent: jest.fn(),\r\n              })),\r\n            });\r\n\r\n            const { container } = render(\r\n              <Modal isOpen={true} onClose={() => {}} title=\"–°–æ–∑–¥–∞—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é\" size=\"md\">\r\n                <CategoryForm\r\n                  onSubmit={async () => {}}\r\n                  onCancel={() => {}}\r\n                />\r\n              </Modal>\r\n            );\r\n\r\n            const responsiveContainers = findResponsiveFlexContainers(container);\r\n\r\n            expect(responsiveContainers.length).toBeGreaterThan(0);\r\n\r\n            responsiveContainers.forEach((flexContainer) => {\r\n              // Should have both mobile and desktop classes\r\n              expect(hasVerticalLayout(flexContainer)).toBe(true);\r\n              expect(hasResponsiveHorizontalLayout(flexContainer)).toBe(true);\r\n            });\r\n          }\r\n        ),\r\n        { numRuns: getNumRuns(\"SLOW\") }\r\n      );\r\n    });\r\n  });\r\n\r\n  describe(\"TransactionForm in modal\", () => {\r\n    it(\"should render form fields in vertical layout by default\", () => {\r\n      jest.setTimeout(getTimeout(\"SLOW\"));\r\n      fc.assert(\r\n        fc.property(\r\n          fc.integer({ min: 320, max: 1440 }),\r\n          (viewportWidth) => {\r\n            Object.defineProperty(window, \"innerWidth\", {\r\n              writable: true,\r\n              configurable: true,\r\n              value: viewportWidth,\r\n            });\r\n\r\n            const { container } = render(\r\n              <Modal isOpen={true} onClose={() => {}} title=\"–°–æ–∑–¥–∞—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é\" size=\"md\">\r\n                <TransactionForm\r\n                  categories={mockCategories}\r\n                  onSubmit={async () => {}}\r\n                  onCancel={() => {}}\r\n                />\r\n              </Modal>\r\n            );\r\n\r\n            // TransactionForm uses space-y-4 which creates vertical layout\r\n            const form = container.querySelector(\"form\");\r\n\r\n            if (form) {\r\n              // Form should have space-y-4 for vertical spacing\r\n              expect(form).toHaveClass(\"space-y-4\");\r\n            }\r\n          }\r\n        ),\r\n        { numRuns: getNumRuns(\"SLOW\") }\r\n      );\r\n    });\r\n  });\r\n\r\n  describe(\"Requirement validation\", () => {\r\n    it(\"validates Requirement 4.3: Form fields arranged vertically below 640px\", () => {\r\n      jest.setTimeout(getTimeout(\"SLOW\"));\r\n      fc.assert(\r\n        fc.property(\r\n          fc.integer({ min: 320, max: 639 }), // Mobile viewport (< 640px as per requirement)\r\n          (viewportWidth) => {\r\n            Object.defineProperty(window, \"innerWidth\", {\r\n              writable: true,\r\n              configurable: true,\r\n              value: viewportWidth,\r\n            });\r\n\r\n            Object.defineProperty(window, \"matchMedia\", {\r\n              writable: true,\r\n              value: jest.fn().mockImplementation((query) => ({\r\n                matches: query.includes(\"640px\") ? false : true,\r\n                media: query,\r\n                onchange: null,\r\n                addListener: jest.fn(),\r\n                removeListener: jest.fn(),\r\n                addEventListener: jest.fn(),\r\n                removeEventListener: jest.fn(),\r\n                dispatchEvent: jest.fn(),\r\n              })),\r\n            });\r\n\r\n            // Requirement 4.3: WHEN —Ñ–æ—Ä–º–∞ –≤ –º–æ–¥–∞–ª—å–Ω–æ–º –æ–∫–Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –º–Ω–æ–∂–µ—Å—Ç–≤–æ –ø–æ–ª–µ–π,\r\n            // THE –°–∏—Å—Ç–µ–º–∞ SHALL —Ä–∞—Å–ø–æ–ª–∞–≥–∞—Ç—å –ø–æ–ª—è –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ –≤ –æ–¥–Ω—É –∫–æ–ª–æ–Ω–∫—É –Ω–∞ —ç–∫—Ä–∞–Ω–∞—Ö –º–µ–Ω–µ–µ 640px\r\n            const { container } = render(\r\n              <Modal isOpen={true} onClose={() => {}} title=\"–°–æ–∑–¥–∞—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é\" size=\"md\">\r\n                <CategoryForm\r\n                  onSubmit={async () => {}}\r\n                  onCancel={() => {}}\r\n                />\r\n              </Modal>\r\n            );\r\n\r\n            // Check that form fields use vertical layout\r\n            const form = container.querySelector(\"form\");\r\n            expect(form).not.toBeNull();\r\n\r\n            if (form) {\r\n              // Form should use vertical spacing\r\n              expect(form).toHaveClass(\"space-y-4\");\r\n            }\r\n\r\n            // Check responsive flex containers\r\n            const responsiveContainers = findResponsiveFlexContainers(container);\r\n\r\n            responsiveContainers.forEach((flexContainer) => {\r\n              // Must have flex-col for vertical layout on mobile\r\n              expect(hasVerticalLayout(flexContainer)).toBe(true);\r\n            });\r\n          }\r\n        ),\r\n        { numRuns: getNumRuns(\"SLOW\") }\r\n      );\r\n    });\r\n  });\r\n});\r\n"],"names":["describeOrSkip","process","env","CI","describe","skip","findResponsiveFlexContainers","container","selectors","elements","forEach","selector","found","querySelectorAll","el","push","hasVerticalLayout","element","classList","contains","hasResponsiveHorizontalLayout","className","includes","mockCategories","id","name","icon","color","type","createdAt","updatedAt","it","jest","setTimeout","getTimeout","fc","assert","property","integer","min","max","viewportWidth","Object","defineProperty","window","writable","configurable","value","fn","mockImplementation","query","matches","media","onchange","addListener","removeListener","addEventListener","removeEventListener","dispatchEvent","render","Modal","isOpen","onClose","title","size","CategoryForm","onSubmit","onCancel","responsiveContainers","expect","length","toBeGreaterThan","flexContainer","toBe","numRuns","getNumRuns","TransactionForm","categories","form","querySelector","toHaveClass","not","toBeNull"],"mappings":"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"}