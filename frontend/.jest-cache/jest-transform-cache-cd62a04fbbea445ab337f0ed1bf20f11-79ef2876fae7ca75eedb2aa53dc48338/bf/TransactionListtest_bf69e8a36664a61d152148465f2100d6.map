{"version":3,"sources":["E:\\my\\otus\\finance_tracker\\frontend\\__tests__\\components\\TransactionList.test.tsx"],"sourcesContent":["import React from 'react';\r\nimport { render, screen } from '@testing-library/react';\r\nimport { TransactionList } from '@/components/transactions/TransactionList';\r\nimport { Transaction } from '@/types/api';\r\n\r\n// Mock the useBreakpoint hook\r\njest.mock('@/hooks/useBreakpoint', () => ({\r\n  useBreakpoint: jest.fn(),\r\n}));\r\n\r\n// Mock the TransactionTable component\r\njest.mock('@/components/transactions/TransactionTable', () => ({\r\n  TransactionTable: jest.fn(() => <div data-testid=\"transaction-table\">Table View</div>),\r\n}));\r\n\r\n// Mock the TransactionCard component\r\njest.mock('@/components/transactions/TransactionCard', () => ({\r\n  TransactionCard: jest.fn(({ transaction }) => (\r\n    <div data-testid={`transaction-card-${transaction.id}`}>Card View</div>\r\n  )),\r\n}));\r\n\r\n// Mock the Pagination component\r\njest.mock('@/components/ui', () => ({\r\n  Pagination: jest.fn(() => <div data-testid=\"pagination\">Pagination</div>),\r\n}));\r\n\r\nimport { useBreakpoint } from '@/hooks/useBreakpoint';\r\n\r\ndescribe('TransactionList', () => {\r\n  const mockTransactions: Transaction[] = [\r\n    {\r\n      id: 'tx-1',\r\n      type: 'expense',\r\n      amount: 100,\r\n      currency: 'USD',\r\n      categoryId: 'cat-1',\r\n      description: 'Test transaction 1',\r\n      transactionDate: '2024-01-15T00:00:00Z',\r\n      isRecurring: false,\r\n      createdAt: '2024-01-15T10:00:00Z',\r\n      updatedAt: '2024-01-15T10:00:00Z',\r\n    },\r\n    {\r\n      id: 'tx-2',\r\n      type: 'income',\r\n      amount: 200,\r\n      currency: 'USD',\r\n      categoryId: 'cat-2',\r\n      description: 'Test transaction 2',\r\n      transactionDate: '2024-01-16T00:00:00Z',\r\n      isRecurring: false,\r\n      createdAt: '2024-01-16T10:00:00Z',\r\n      updatedAt: '2024-01-16T10:00:00Z',\r\n    },\r\n  ];\r\n\r\n  const defaultProps = {\r\n    transactions: mockTransactions,\r\n    loading: false,\r\n    currentPage: 1,\r\n    totalPages: 1,\r\n    totalItems: 2,\r\n    pageSize: 10,\r\n    onPageChange: jest.fn(),\r\n    onEdit: jest.fn(),\r\n    onDelete: jest.fn(),\r\n  };\r\n\r\n  beforeEach(() => {\r\n    jest.clearAllMocks();\r\n  });\r\n\r\n  describe('Requirement 8.1: Conditional rendering based on viewport width', () => {\r\n    it('should render table view on desktop (viewport >= 768px)', () => {\r\n      // Mock desktop viewport\r\n      (useBreakpoint as jest.Mock).mockReturnValue({\r\n        width: 1024,\r\n        isMobile: false,\r\n        isTablet: false,\r\n        isDesktop: true,\r\n        currentBreakpoint: 'lg',\r\n      });\r\n\r\n      render(<TransactionList {...defaultProps} />);\r\n\r\n      // Should render table view\r\n      expect(screen.getByTestId('transaction-table')).toBeInTheDocument();\r\n      \r\n      // Should not render card views\r\n      expect(screen.queryByTestId('transaction-card-tx-1')).not.toBeInTheDocument();\r\n      expect(screen.queryByTestId('transaction-card-tx-2')).not.toBeInTheDocument();\r\n    });\r\n\r\n    it('should render card view on mobile (viewport < 768px)', () => {\r\n      // Mock mobile viewport\r\n      (useBreakpoint as jest.Mock).mockReturnValue({\r\n        width: 375,\r\n        isMobile: true,\r\n        isTablet: false,\r\n        isDesktop: false,\r\n        currentBreakpoint: 'xs',\r\n      });\r\n\r\n      render(<TransactionList {...defaultProps} />);\r\n\r\n      // Should render card views\r\n      expect(screen.getByTestId('transaction-card-tx-1')).toBeInTheDocument();\r\n      expect(screen.getByTestId('transaction-card-tx-2')).toBeInTheDocument();\r\n      \r\n      // Should not render table view\r\n      expect(screen.queryByTestId('transaction-table')).not.toBeInTheDocument();\r\n    });\r\n\r\n    it('should render table view at exactly 768px breakpoint', () => {\r\n      // Mock viewport at exactly 768px (md breakpoint)\r\n      (useBreakpoint as jest.Mock).mockReturnValue({\r\n        width: 768,\r\n        isMobile: false,\r\n        isTablet: true,\r\n        isDesktop: false,\r\n        currentBreakpoint: 'md',\r\n      });\r\n\r\n      render(<TransactionList {...defaultProps} />);\r\n\r\n      // Should render table view (>= 768px)\r\n      expect(screen.getByTestId('transaction-table')).toBeInTheDocument();\r\n      expect(screen.queryByTestId('transaction-card-tx-1')).not.toBeInTheDocument();\r\n    });\r\n\r\n    it('should render card view at 767px (just below breakpoint)', () => {\r\n      // Mock viewport at 767px (just below md breakpoint)\r\n      (useBreakpoint as jest.Mock).mockReturnValue({\r\n        width: 767,\r\n        isMobile: false,\r\n        isTablet: true,\r\n        isDesktop: false,\r\n        currentBreakpoint: 'sm',\r\n      });\r\n\r\n      render(<TransactionList {...defaultProps} />);\r\n\r\n      // Should render card view (< 768px)\r\n      expect(screen.getByTestId('transaction-card-tx-1')).toBeInTheDocument();\r\n      expect(screen.queryByTestId('transaction-table')).not.toBeInTheDocument();\r\n    });\r\n  });\r\n\r\n  describe('Loading state', () => {\r\n    it('should show loading skeleton on mobile when loading', () => {\r\n      (useBreakpoint as jest.Mock).mockReturnValue({\r\n        width: 375,\r\n        isMobile: true,\r\n        isTablet: false,\r\n        isDesktop: false,\r\n        currentBreakpoint: 'xs',\r\n      });\r\n\r\n      render(<TransactionList {...defaultProps} loading={true} />);\r\n\r\n      // Should show loading skeletons\r\n      const loadingElements = screen.getAllByRole('status', { name: /Loading/ });\r\n      expect(loadingElements).toHaveLength(5);\r\n    });\r\n\r\n    it('should delegate loading state to table view on desktop', () => {\r\n      (useBreakpoint as jest.Mock).mockReturnValue({\r\n        width: 1024,\r\n        isMobile: false,\r\n        isTablet: false,\r\n        isDesktop: true,\r\n        currentBreakpoint: 'lg',\r\n      });\r\n\r\n      render(<TransactionList {...defaultProps} loading={true} />);\r\n\r\n      // Should render table view (which handles its own loading state)\r\n      expect(screen.getByTestId('transaction-table')).toBeInTheDocument();\r\n    });\r\n  });\r\n\r\n  describe('Empty state', () => {\r\n    it('should show empty state on mobile when no transactions', () => {\r\n      (useBreakpoint as jest.Mock).mockReturnValue({\r\n        width: 375,\r\n        isMobile: true,\r\n        isTablet: false,\r\n        isDesktop: false,\r\n        currentBreakpoint: 'xs',\r\n      });\r\n\r\n      render(<TransactionList {...defaultProps} transactions={[]} />);\r\n\r\n      expect(screen.getByText('Нет транзакций')).toBeInTheDocument();\r\n      expect(screen.getByText('Начните с создания новой транзакции')).toBeInTheDocument();\r\n    });\r\n\r\n    it('should delegate empty state to table view on desktop', () => {\r\n      (useBreakpoint as jest.Mock).mockReturnValue({\r\n        width: 1024,\r\n        isMobile: false,\r\n        isTablet: false,\r\n        isDesktop: true,\r\n        currentBreakpoint: 'lg',\r\n      });\r\n\r\n      render(<TransactionList {...defaultProps} transactions={[]} />);\r\n\r\n      // Should render table view (which handles its own empty state)\r\n      expect(screen.getByTestId('transaction-table')).toBeInTheDocument();\r\n    });\r\n  });\r\n\r\n  describe('Pagination', () => {\r\n    it('should show pagination on mobile when multiple pages exist', () => {\r\n      (useBreakpoint as jest.Mock).mockReturnValue({\r\n        width: 375,\r\n        isMobile: true,\r\n        isTablet: false,\r\n        isDesktop: false,\r\n        currentBreakpoint: 'xs',\r\n      });\r\n\r\n      render(<TransactionList {...defaultProps} totalPages={3} />);\r\n\r\n      expect(screen.getByTestId('pagination')).toBeInTheDocument();\r\n    });\r\n\r\n    it('should not show pagination on mobile when only one page', () => {\r\n      (useBreakpoint as jest.Mock).mockReturnValue({\r\n        width: 375,\r\n        isMobile: true,\r\n        isTablet: false,\r\n        isDesktop: false,\r\n        currentBreakpoint: 'xs',\r\n      });\r\n\r\n      render(<TransactionList {...defaultProps} totalPages={1} />);\r\n\r\n      expect(screen.queryByTestId('pagination')).not.toBeInTheDocument();\r\n    });\r\n  });\r\n});\r\n"],"names":["jest","mock","useBreakpoint","fn","TransactionTable","div","data-testid","TransactionCard","transaction","id","Pagination","describe","mockTransactions","type","amount","currency","categoryId","description","transactionDate","isRecurring","createdAt","updatedAt","defaultProps","transactions","loading","currentPage","totalPages","totalItems","pageSize","onPageChange","onEdit","onDelete","beforeEach","clearAllMocks","it","mockReturnValue","width","isMobile","isTablet","isDesktop","currentBreakpoint","render","TransactionList","expect","screen","getByTestId","toBeInTheDocument","queryByTestId","not","loadingElements","getAllByRole","name","toHaveLength","getByText"],"mappings":"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"}