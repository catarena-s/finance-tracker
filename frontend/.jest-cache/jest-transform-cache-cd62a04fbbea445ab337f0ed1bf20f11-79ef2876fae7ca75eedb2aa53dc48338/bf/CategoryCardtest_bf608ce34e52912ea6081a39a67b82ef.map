{"version":3,"sources":["E:\\my\\otus\\finance_tracker\\frontend\\__tests__\\components\\CategoryCard.test.tsx"],"sourcesContent":["/**\r\n * Unit tests — CategoryCard\r\n * Тестирование отображения кнопок действий на карточках категорий\r\n * Требования: 5.3\r\n */\r\nimport React from \"react\";\r\nimport { render, screen } from \"@testing-library/react\";\r\nimport { CategoryCard } from \"@/components/categories/CategoryCard\";\r\nimport type { Category } from \"@/types/api\";\r\n\r\ndescribe(\"CategoryCard\", () => {\r\n  const mockCategory: Category = {\r\n    id: \"1\",\r\n    name: \"Продукты\",\r\n    type: \"expense\",\r\n    icon: \"ShoppingCart\",\r\n    color: \"#10b981\",\r\n    createdAt: \"2024-01-01T00:00:00Z\",\r\n    updatedAt: \"2024-01-01T00:00:00Z\",\r\n  };\r\n\r\n  const mockOnEdit = jest.fn();\r\n  const mockOnDelete = jest.fn();\r\n\r\n  beforeEach(() => {\r\n    jest.clearAllMocks();\r\n  });\r\n\r\n  describe(\"action buttons visibility\", () => {\r\n    it(\"should have action buttons always visible on mobile devices\", () => {\r\n      // Устанавливаем мобильный viewport (< 640px)\r\n      Object.defineProperty(window, \"innerWidth\", {\r\n        writable: true,\r\n        configurable: true,\r\n        value: 375,\r\n      });\r\n\r\n      const { container } = render(\r\n        <CategoryCard\r\n          category={mockCategory}\r\n          onEdit={mockOnEdit}\r\n          onDelete={mockOnDelete}\r\n        />\r\n      );\r\n\r\n      // Находим контейнер с кнопками действий\r\n      const actionButtonsContainer = container.querySelector(\r\n        \".opacity-100\"\r\n      );\r\n      expect(actionButtonsContainer).toBeInTheDocument();\r\n\r\n      // Проверяем, что кнопки редактирования и удаления присутствуют\r\n      const editButton = screen.getByLabelText(\"Редактировать\");\r\n      const deleteButton = screen.getByLabelText(\"Удалить\");\r\n\r\n      expect(editButton).toBeInTheDocument();\r\n      expect(deleteButton).toBeInTheDocument();\r\n\r\n      // Проверяем, что контейнер имеет класс opacity-100 (всегда видимый)\r\n      expect(actionButtonsContainer).toHaveClass(\"opacity-100\");\r\n    });\r\n\r\n    it(\"should have action buttons hidden by default on desktop (visible on hover)\", () => {\r\n      // Устанавливаем desktop viewport (>= 640px)\r\n      Object.defineProperty(window, \"innerWidth\", {\r\n        writable: true,\r\n        configurable: true,\r\n        value: 1024,\r\n      });\r\n\r\n      const { container } = render(\r\n        <CategoryCard\r\n          category={mockCategory}\r\n          onEdit={mockOnEdit}\r\n          onDelete={mockOnDelete}\r\n        />\r\n      );\r\n\r\n      // Находим контейнер с кнопками действий\r\n      const actionButtonsContainer = container.querySelector(\r\n        \".sm\\\\:opacity-0\"\r\n      );\r\n      expect(actionButtonsContainer).toBeInTheDocument();\r\n\r\n      // Проверяем, что контейнер имеет класс sm:opacity-0 (скрыт по умолчанию на desktop)\r\n      expect(actionButtonsContainer).toHaveClass(\"sm:opacity-0\");\r\n\r\n      // Проверяем, что контейнер имеет класс sm:group-hover:opacity-100 (виден при hover)\r\n      expect(actionButtonsContainer).toHaveClass(\"sm:group-hover:opacity-100\");\r\n    });\r\n\r\n    it(\"should render both edit and delete buttons\", () => {\r\n      render(\r\n        <CategoryCard\r\n          category={mockCategory}\r\n          onEdit={mockOnEdit}\r\n          onDelete={mockOnDelete}\r\n        />\r\n      );\r\n\r\n      // Проверяем наличие обеих кнопок\r\n      const editButton = screen.getByLabelText(\"Редактировать\");\r\n      const deleteButton = screen.getByLabelText(\"Удалить\");\r\n\r\n      expect(editButton).toBeInTheDocument();\r\n      expect(deleteButton).toBeInTheDocument();\r\n    });\r\n\r\n    it(\"should have appropriate button sizes on mobile (36x36px minimum)\", () => {\r\n      // Устанавливаем мобильный viewport\r\n      Object.defineProperty(window, \"innerWidth\", {\r\n        writable: true,\r\n        configurable: true,\r\n        value: 375,\r\n      });\r\n\r\n      const { container } = render(\r\n        <CategoryCard\r\n          category={mockCategory}\r\n          onEdit={mockOnEdit}\r\n          onDelete={mockOnDelete}\r\n        />\r\n      );\r\n\r\n      // Проверяем, что кнопки имеют класс h-9 w-9 (36x36px на мобильных)\r\n      const buttons = container.querySelectorAll(\".h-9.w-9\");\r\n      expect(buttons.length).toBe(2); // Две кнопки: редактировать и удалить\r\n    });\r\n\r\n    it(\"should have appropriate button sizes on desktop (32x32px)\", () => {\r\n      // Устанавливаем desktop viewport\r\n      Object.defineProperty(window, \"innerWidth\", {\r\n        writable: true,\r\n        configurable: true,\r\n        value: 1024,\r\n      });\r\n\r\n      const { container } = render(\r\n        <CategoryCard\r\n          category={mockCategory}\r\n          onEdit={mockOnEdit}\r\n          onDelete={mockOnDelete}\r\n        />\r\n      );\r\n\r\n      // Проверяем, что кнопки имеют класс sm:h-8 sm:w-8 (32x32px на desktop)\r\n      const buttons = container.querySelectorAll(\".sm\\\\:h-8.sm\\\\:w-8\");\r\n      expect(buttons.length).toBe(2); // Две кнопки: редактировать и удалить\r\n    });\r\n  });\r\n\r\n  describe(\"category information display\", () => {\r\n    it(\"should display category name\", () => {\r\n      render(\r\n        <CategoryCard\r\n          category={mockCategory}\r\n          onEdit={mockOnEdit}\r\n          onDelete={mockOnDelete}\r\n        />\r\n      );\r\n\r\n      expect(screen.getByText(\"Продукты\")).toBeInTheDocument();\r\n    });\r\n\r\n    it(\"should display category type badge for expense\", () => {\r\n      render(\r\n        <CategoryCard\r\n          category={mockCategory}\r\n          onEdit={mockOnEdit}\r\n          onDelete={mockOnDelete}\r\n        />\r\n      );\r\n\r\n      expect(screen.getByText(\"Расход\")).toBeInTheDocument();\r\n    });\r\n\r\n    it(\"should display category type badge for income\", () => {\r\n      const incomeCategory: Category = {\r\n        ...mockCategory,\r\n        type: \"income\",\r\n      };\r\n\r\n      render(\r\n        <CategoryCard\r\n          category={incomeCategory}\r\n          onEdit={mockOnEdit}\r\n          onDelete={mockOnDelete}\r\n        />\r\n      );\r\n\r\n      expect(screen.getByText(\"Доход\")).toBeInTheDocument();\r\n    });\r\n\r\n    it(\"should truncate long category names\", () => {\r\n      const longNameCategory: Category = {\r\n        ...mockCategory,\r\n        name: \"Очень длинное название категории которое должно быть обрезано\",\r\n      };\r\n\r\n      const { container } = render(\r\n        <CategoryCard\r\n          category={longNameCategory}\r\n          onEdit={mockOnEdit}\r\n          onDelete={mockOnDelete}\r\n        />\r\n      );\r\n\r\n      // Проверяем, что название имеет класс truncate\r\n      const nameElement = container.querySelector(\".truncate\");\r\n      expect(nameElement).toBeInTheDocument();\r\n      expect(nameElement).toHaveTextContent(longNameCategory.name);\r\n    });\r\n  });\r\n\r\n  describe(\"icon and color display\", () => {\r\n    it(\"should display category icon with correct color\", () => {\r\n      const { container } = render(\r\n        <CategoryCard\r\n          category={mockCategory}\r\n          onEdit={mockOnEdit}\r\n          onDelete={mockOnDelete}\r\n        />\r\n      );\r\n\r\n      // Проверяем наличие иконки\r\n      const iconContainer = container.querySelector('[aria-label=\"Иконка категории\"]');\r\n      expect(iconContainer).toBeInTheDocument();\r\n\r\n      // Проверяем, что иконка имеет правильный цвет фона\r\n      expect(iconContainer).toHaveStyle({\r\n        backgroundColor: `${mockCategory.color}20`,\r\n      });\r\n    });\r\n\r\n    it(\"should display color indicator\", () => {\r\n      const { container } = render(\r\n        <CategoryCard\r\n          category={mockCategory}\r\n          onEdit={mockOnEdit}\r\n          onDelete={mockOnDelete}\r\n        />\r\n      );\r\n\r\n      // Проверяем наличие цветового индикатора\r\n      const colorIndicator = container.querySelector(\r\n        `[aria-label=\"Цвет категории: ${mockCategory.color}\"]`\r\n      );\r\n      expect(colorIndicator).toBeInTheDocument();\r\n      expect(colorIndicator).toHaveStyle({\r\n        backgroundColor: mockCategory.color,\r\n      });\r\n    });\r\n\r\n    it(\"should maintain icon proportions (square aspect ratio)\", () => {\r\n      const { container } = render(\r\n        <CategoryCard\r\n          category={mockCategory}\r\n          onEdit={mockOnEdit}\r\n          onDelete={mockOnDelete}\r\n        />\r\n      );\r\n\r\n      // Проверяем, что контейнер иконки имеет одинаковые высоту и ширину\r\n      const iconContainer = container.querySelector(\".h-11.w-11\");\r\n      expect(iconContainer).toBeInTheDocument();\r\n    });\r\n  });\r\n\r\n  describe(\"interaction\", () => {\r\n    it(\"should call onEdit when edit button is clicked\", () => {\r\n      render(\r\n        <CategoryCard\r\n          category={mockCategory}\r\n          onEdit={mockOnEdit}\r\n          onDelete={mockOnDelete}\r\n        />\r\n      );\r\n\r\n      const editButton = screen.getByLabelText(\"Редактировать\");\r\n      editButton.click();\r\n\r\n      expect(mockOnEdit).toHaveBeenCalledTimes(1);\r\n      expect(mockOnEdit).toHaveBeenCalledWith(mockCategory);\r\n    });\r\n\r\n    it(\"should call onDelete when delete button is clicked\", () => {\r\n      render(\r\n        <CategoryCard\r\n          category={mockCategory}\r\n          onEdit={mockOnEdit}\r\n          onDelete={mockOnDelete}\r\n        />\r\n      );\r\n\r\n      const deleteButton = screen.getByLabelText(\"Удалить\");\r\n      deleteButton.click();\r\n\r\n      expect(mockOnDelete).toHaveBeenCalledTimes(1);\r\n      expect(mockOnDelete).toHaveBeenCalledWith(mockCategory.id);\r\n    });\r\n  });\r\n\r\n  describe(\"hover effects\", () => {\r\n    it(\"should have group class for hover effects\", () => {\r\n      const { container } = render(\r\n        <CategoryCard\r\n          category={mockCategory}\r\n          onEdit={mockOnEdit}\r\n          onDelete={mockOnDelete}\r\n        />\r\n      );\r\n\r\n      // Проверяем, что карточка имеет класс group для hover эффектов\r\n      const card = container.querySelector(\".group\");\r\n      expect(card).toBeInTheDocument();\r\n    });\r\n\r\n    it(\"should have transition classes for smooth animations\", () => {\r\n      const { container } = render(\r\n        <CategoryCard\r\n          category={mockCategory}\r\n          onEdit={mockOnEdit}\r\n          onDelete={mockOnDelete}\r\n        />\r\n      );\r\n\r\n      // Проверяем наличие transition классов\r\n      const actionButtonsContainer = container.querySelector(\".transition-opacity\");\r\n      expect(actionButtonsContainer).toBeInTheDocument();\r\n    });\r\n  });\r\n});\r\n"],"names":["describe","mockCategory","id","name","type","icon","color","createdAt","updatedAt","mockOnEdit","jest","fn","mockOnDelete","beforeEach","clearAllMocks","it","Object","defineProperty","window","writable","configurable","value","container","render","CategoryCard","category","onEdit","onDelete","actionButtonsContainer","querySelector","expect","toBeInTheDocument","editButton","screen","getByLabelText","deleteButton","toHaveClass","buttons","querySelectorAll","length","toBe","getByText","incomeCategory","longNameCategory","nameElement","toHaveTextContent","iconContainer","toHaveStyle","backgroundColor","colorIndicator","click","toHaveBeenCalledTimes","toHaveBeenCalledWith","card"],"mappings":"AAAA;;;;CAIC;;;;;8DACiB;wBACa;8BACF;;;;;;AAG7BA,SAAS,gBAAgB;IACvB,MAAMC,eAAyB;QAC7BC,IAAI;QACJC,MAAM;QACNC,MAAM;QACNC,MAAM;QACNC,OAAO;QACPC,WAAW;QACXC,WAAW;IACb;IAEA,MAAMC,aAAaC,KAAKC,EAAE;IAC1B,MAAMC,eAAeF,KAAKC,EAAE;IAE5BE,WAAW;QACTH,KAAKI,aAAa;IACpB;IAEAd,SAAS,6BAA6B;QACpCe,GAAG,+DAA+D;YAChE,6CAA6C;YAC7CC,OAAOC,cAAc,CAACC,QAAQ,cAAc;gBAC1CC,UAAU;gBACVC,cAAc;gBACdC,OAAO;YACT;YAEA,MAAM,EAAEC,SAAS,EAAE,GAAGC,IAAAA,cAAM,gBAC1B,qBAACC,0BAAY;gBACXC,UAAUxB;gBACVyB,QAAQjB;gBACRkB,UAAUf;;YAId,wCAAwC;YACxC,MAAMgB,yBAAyBN,UAAUO,aAAa,CACpD;YAEFC,OAAOF,wBAAwBG,iBAAiB;YAEhD,+DAA+D;YAC/D,MAAMC,aAAaC,cAAM,CAACC,cAAc,CAAC;YACzC,MAAMC,eAAeF,cAAM,CAACC,cAAc,CAAC;YAE3CJ,OAAOE,YAAYD,iBAAiB;YACpCD,OAAOK,cAAcJ,iBAAiB;YAEtC,oEAAoE;YACpED,OAAOF,wBAAwBQ,WAAW,CAAC;QAC7C;QAEArB,GAAG,8EAA8E;YAC/E,4CAA4C;YAC5CC,OAAOC,cAAc,CAACC,QAAQ,cAAc;gBAC1CC,UAAU;gBACVC,cAAc;gBACdC,OAAO;YACT;YAEA,MAAM,EAAEC,SAAS,EAAE,GAAGC,IAAAA,cAAM,gBAC1B,qBAACC,0BAAY;gBACXC,UAAUxB;gBACVyB,QAAQjB;gBACRkB,UAAUf;;YAId,wCAAwC;YACxC,MAAMgB,yBAAyBN,UAAUO,aAAa,CACpD;YAEFC,OAAOF,wBAAwBG,iBAAiB;YAEhD,oFAAoF;YACpFD,OAAOF,wBAAwBQ,WAAW,CAAC;YAE3C,oFAAoF;YACpFN,OAAOF,wBAAwBQ,WAAW,CAAC;QAC7C;QAEArB,GAAG,8CAA8C;YAC/CQ,IAAAA,cAAM,gBACJ,qBAACC,0BAAY;gBACXC,UAAUxB;gBACVyB,QAAQjB;gBACRkB,UAAUf;;YAId,iCAAiC;YACjC,MAAMoB,aAAaC,cAAM,CAACC,cAAc,CAAC;YACzC,MAAMC,eAAeF,cAAM,CAACC,cAAc,CAAC;YAE3CJ,OAAOE,YAAYD,iBAAiB;YACpCD,OAAOK,cAAcJ,iBAAiB;QACxC;QAEAhB,GAAG,oEAAoE;YACrE,mCAAmC;YACnCC,OAAOC,cAAc,CAACC,QAAQ,cAAc;gBAC1CC,UAAU;gBACVC,cAAc;gBACdC,OAAO;YACT;YAEA,MAAM,EAAEC,SAAS,EAAE,GAAGC,IAAAA,cAAM,gBAC1B,qBAACC,0BAAY;gBACXC,UAAUxB;gBACVyB,QAAQjB;gBACRkB,UAAUf;;YAId,mEAAmE;YACnE,MAAMyB,UAAUf,UAAUgB,gBAAgB,CAAC;YAC3CR,OAAOO,QAAQE,MAAM,EAAEC,IAAI,CAAC,IAAI,sCAAsC;QACxE;QAEAzB,GAAG,6DAA6D;YAC9D,iCAAiC;YACjCC,OAAOC,cAAc,CAACC,QAAQ,cAAc;gBAC1CC,UAAU;gBACVC,cAAc;gBACdC,OAAO;YACT;YAEA,MAAM,EAAEC,SAAS,EAAE,GAAGC,IAAAA,cAAM,gBAC1B,qBAACC,0BAAY;gBACXC,UAAUxB;gBACVyB,QAAQjB;gBACRkB,UAAUf;;YAId,uEAAuE;YACvE,MAAMyB,UAAUf,UAAUgB,gBAAgB,CAAC;YAC3CR,OAAOO,QAAQE,MAAM,EAAEC,IAAI,CAAC,IAAI,sCAAsC;QACxE;IACF;IAEAxC,SAAS,gCAAgC;QACvCe,GAAG,gCAAgC;YACjCQ,IAAAA,cAAM,gBACJ,qBAACC,0BAAY;gBACXC,UAAUxB;gBACVyB,QAAQjB;gBACRkB,UAAUf;;YAIdkB,OAAOG,cAAM,CAACQ,SAAS,CAAC,aAAaV,iBAAiB;QACxD;QAEAhB,GAAG,kDAAkD;YACnDQ,IAAAA,cAAM,gBACJ,qBAACC,0BAAY;gBACXC,UAAUxB;gBACVyB,QAAQjB;gBACRkB,UAAUf;;YAIdkB,OAAOG,cAAM,CAACQ,SAAS,CAAC,WAAWV,iBAAiB;QACtD;QAEAhB,GAAG,iDAAiD;YAClD,MAAM2B,iBAA2B;gBAC/B,GAAGzC,YAAY;gBACfG,MAAM;YACR;YAEAmB,IAAAA,cAAM,gBACJ,qBAACC,0BAAY;gBACXC,UAAUiB;gBACVhB,QAAQjB;gBACRkB,UAAUf;;YAIdkB,OAAOG,cAAM,CAACQ,SAAS,CAAC,UAAUV,iBAAiB;QACrD;QAEAhB,GAAG,uCAAuC;YACxC,MAAM4B,mBAA6B;gBACjC,GAAG1C,YAAY;gBACfE,MAAM;YACR;YAEA,MAAM,EAAEmB,SAAS,EAAE,GAAGC,IAAAA,cAAM,gBAC1B,qBAACC,0BAAY;gBACXC,UAAUkB;gBACVjB,QAAQjB;gBACRkB,UAAUf;;YAId,+CAA+C;YAC/C,MAAMgC,cAActB,UAAUO,aAAa,CAAC;YAC5CC,OAAOc,aAAab,iBAAiB;YACrCD,OAAOc,aAAaC,iBAAiB,CAACF,iBAAiBxC,IAAI;QAC7D;IACF;IAEAH,SAAS,0BAA0B;QACjCe,GAAG,mDAAmD;YACpD,MAAM,EAAEO,SAAS,EAAE,GAAGC,IAAAA,cAAM,gBAC1B,qBAACC,0BAAY;gBACXC,UAAUxB;gBACVyB,QAAQjB;gBACRkB,UAAUf;;YAId,2BAA2B;YAC3B,MAAMkC,gBAAgBxB,UAAUO,aAAa,CAAC;YAC9CC,OAAOgB,eAAef,iBAAiB;YAEvC,mDAAmD;YACnDD,OAAOgB,eAAeC,WAAW,CAAC;gBAChCC,iBAAiB,CAAC,EAAE/C,aAAaK,KAAK,CAAC,EAAE,CAAC;YAC5C;QACF;QAEAS,GAAG,kCAAkC;YACnC,MAAM,EAAEO,SAAS,EAAE,GAAGC,IAAAA,cAAM,gBAC1B,qBAACC,0BAAY;gBACXC,UAAUxB;gBACVyB,QAAQjB;gBACRkB,UAAUf;;YAId,yCAAyC;YACzC,MAAMqC,iBAAiB3B,UAAUO,aAAa,CAC5C,CAAC,6BAA6B,EAAE5B,aAAaK,KAAK,CAAC,EAAE,CAAC;YAExDwB,OAAOmB,gBAAgBlB,iBAAiB;YACxCD,OAAOmB,gBAAgBF,WAAW,CAAC;gBACjCC,iBAAiB/C,aAAaK,KAAK;YACrC;QACF;QAEAS,GAAG,0DAA0D;YAC3D,MAAM,EAAEO,SAAS,EAAE,GAAGC,IAAAA,cAAM,gBAC1B,qBAACC,0BAAY;gBACXC,UAAUxB;gBACVyB,QAAQjB;gBACRkB,UAAUf;;YAId,mEAAmE;YACnE,MAAMkC,gBAAgBxB,UAAUO,aAAa,CAAC;YAC9CC,OAAOgB,eAAef,iBAAiB;QACzC;IACF;IAEA/B,SAAS,eAAe;QACtBe,GAAG,kDAAkD;YACnDQ,IAAAA,cAAM,gBACJ,qBAACC,0BAAY;gBACXC,UAAUxB;gBACVyB,QAAQjB;gBACRkB,UAAUf;;YAId,MAAMoB,aAAaC,cAAM,CAACC,cAAc,CAAC;YACzCF,WAAWkB,KAAK;YAEhBpB,OAAOrB,YAAY0C,qBAAqB,CAAC;YACzCrB,OAAOrB,YAAY2C,oBAAoB,CAACnD;QAC1C;QAEAc,GAAG,sDAAsD;YACvDQ,IAAAA,cAAM,gBACJ,qBAACC,0BAAY;gBACXC,UAAUxB;gBACVyB,QAAQjB;gBACRkB,UAAUf;;YAId,MAAMuB,eAAeF,cAAM,CAACC,cAAc,CAAC;YAC3CC,aAAae,KAAK;YAElBpB,OAAOlB,cAAcuC,qBAAqB,CAAC;YAC3CrB,OAAOlB,cAAcwC,oBAAoB,CAACnD,aAAaC,EAAE;QAC3D;IACF;IAEAF,SAAS,iBAAiB;QACxBe,GAAG,6CAA6C;YAC9C,MAAM,EAAEO,SAAS,EAAE,GAAGC,IAAAA,cAAM,gBAC1B,qBAACC,0BAAY;gBACXC,UAAUxB;gBACVyB,QAAQjB;gBACRkB,UAAUf;;YAId,+DAA+D;YAC/D,MAAMyC,OAAO/B,UAAUO,aAAa,CAAC;YACrCC,OAAOuB,MAAMtB,iBAAiB;QAChC;QAEAhB,GAAG,wDAAwD;YACzD,MAAM,EAAEO,SAAS,EAAE,GAAGC,IAAAA,cAAM,gBAC1B,qBAACC,0BAAY;gBACXC,UAAUxB;gBACVyB,QAAQjB;gBACRkB,UAAUf;;YAId,uCAAuC;YACvC,MAAMgB,yBAAyBN,UAAUO,aAAa,CAAC;YACvDC,OAAOF,wBAAwBG,iBAAiB;QAClD;IACF;AACF"}