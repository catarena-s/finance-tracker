{"version":3,"sources":["E:\\my\\otus\\finance_tracker\\frontend\\__tests__\\components\\BalanceCards.test.tsx"],"sourcesContent":["/**\r\n * Unit tests — BalanceCards\r\n * Тестирование адаптивного поведения карточек баланса\r\n * Требования: 1.1, 1.3\r\n */\r\nimport React from \"react\";\r\nimport { render, screen } from \"@testing-library/react\";\r\nimport { BalanceCards } from \"@/components/dashboard/BalanceCards\";\r\nimport type { SummaryByCurrency } from \"@/types/api\";\r\n\r\ndescribe(\"BalanceCards\", () => {\r\n  const defaultProps = {\r\n    totalIncome: 50000,\r\n    totalExpense: 30000,\r\n    balance: 20000,\r\n    displayCurrency: \"RUB\" as const,\r\n  };\r\n\r\n  describe(\"responsive layout\", () => {\r\n    it(\"should display cards in three columns on all viewports for compactness\", () => {\r\n      const { container } = render(<BalanceCards {...defaultProps} />);\r\n      \r\n      // Проверяем наличие grid контейнера с классом для трех колонок\r\n      const gridContainer = container.querySelector(\".grid\");\r\n      expect(gridContainer).toBeInTheDocument();\r\n      expect(gridContainer).toHaveClass(\"grid-cols-3\");\r\n      \r\n      // Проверяем, что все три карточки отображаются\r\n      expect(screen.getByText(\"Доходы\")).toBeInTheDocument();\r\n      expect(screen.getByText(\"Расходы\")).toBeInTheDocument();\r\n      expect(screen.getByText(\"Баланс\")).toBeInTheDocument();\r\n    });\r\n\r\n    it(\"should have responsive gap between cards\", () => {\r\n      const { container } = render(<BalanceCards {...defaultProps} />);\r\n      \r\n      const gridContainer = container.querySelector(\".grid\");\r\n      expect(gridContainer).toHaveClass(\"gap-2\");\r\n      expect(gridContainer).toHaveClass(\"sm:gap-4\");\r\n      expect(gridContainer).toHaveClass(\"md:gap-6\");\r\n    });\r\n  });\r\n\r\n  describe(\"currency data handling\", () => {\r\n    it(\"should handle empty currency data gracefully\", () => {\r\n      const propsWithEmptyCurrency = {\r\n        ...defaultProps,\r\n        byCurrency: [] as SummaryByCurrency[],\r\n        currencyRates: {},\r\n      };\r\n\r\n      const { container } = render(<BalanceCards {...propsWithEmptyCurrency} />);\r\n      \r\n      // Проверяем, что основные карточки отображаются\r\n      expect(screen.getByText(\"Доходы\")).toBeInTheDocument();\r\n      expect(screen.getByText(\"Расходы\")).toBeInTheDocument();\r\n      expect(screen.getByText(\"Баланс\")).toBeInTheDocument();\r\n      \r\n      // Проверяем, что информация о валютах не отображается\r\n      expect(screen.queryByText(/USD:/)).not.toBeInTheDocument();\r\n      expect(screen.queryByText(/EUR:/)).not.toBeInTheDocument();\r\n      expect(screen.queryByText(/Курсы валют/)).not.toBeInTheDocument();\r\n    });\r\n\r\n    it(\"should not display currency breakdown when byCurrency is undefined\", () => {\r\n      render(<BalanceCards {...defaultProps} />);\r\n      \r\n      // Проверяем, что основные карточки отображаются\r\n      expect(screen.getByText(\"Доходы\")).toBeInTheDocument();\r\n      expect(screen.getByText(\"Расходы\")).toBeInTheDocument();\r\n      expect(screen.getByText(\"Баланс\")).toBeInTheDocument();\r\n      \r\n      // Проверяем, что информация о валютах не отображается\r\n      expect(screen.queryByText(/USD:/)).not.toBeInTheDocument();\r\n      expect(screen.queryByText(/EUR:/)).not.toBeInTheDocument();\r\n    });\r\n\r\n    it(\"should not display currency breakdown when only one currency\", () => {\r\n      const propsWithSingleCurrency = {\r\n        ...defaultProps,\r\n        byCurrency: [\r\n          {\r\n            currency: \"RUB\",\r\n            totalIncome: 50000,\r\n            totalExpense: 30000,\r\n            balance: 20000,\r\n          },\r\n        ] as SummaryByCurrency[],\r\n      };\r\n\r\n      render(<BalanceCards {...propsWithSingleCurrency} />);\r\n      \r\n      // Проверяем, что основные карточки отображаются\r\n      expect(screen.getByText(\"Доходы\")).toBeInTheDocument();\r\n      \r\n      // Когда только одна валюта, разбивка по валютам не отображается в карточках\r\n      const rubBreakdown = screen.queryByText(/RUB:/);\r\n      expect(rubBreakdown).not.toBeInTheDocument();\r\n    });\r\n\r\n    it(\"should display currency breakdown when multiple currencies are provided\", () => {\r\n      const propsWithMultipleCurrencies = {\r\n        ...defaultProps,\r\n        byCurrency: [\r\n          {\r\n            currency: \"USD\",\r\n            totalIncome: 1000,\r\n            totalExpense: 500,\r\n            balance: 500,\r\n          },\r\n          {\r\n            currency: \"EUR\",\r\n            totalIncome: 800,\r\n            totalExpense: 300,\r\n            balance: 500,\r\n          },\r\n        ] as SummaryByCurrency[],\r\n        currencyRates: {\r\n          USD: 75.5,\r\n          EUR: 85.2,\r\n        },\r\n      };\r\n\r\n      render(<BalanceCards {...propsWithMultipleCurrencies} />);\r\n      \r\n      // Проверяем, что валюты отображаются в карточках\r\n      const usdElements = screen.getAllByText(/USD/);\r\n      const eurElements = screen.getAllByText(/EUR/);\r\n      expect(usdElements.length).toBeGreaterThan(0);\r\n      expect(eurElements.length).toBeGreaterThan(0);\r\n      \r\n      // Проверяем, что отображается блок с курсами валют\r\n      expect(screen.getByText(/Курсы валют к RUB:/)).toBeInTheDocument();\r\n    });\r\n  });\r\n\r\n  describe(\"loading state\", () => {\r\n    it(\"should show loading skeletons when loading is true\", () => {\r\n      const { container } = render(\r\n        <BalanceCards {...defaultProps} loading={true} />\r\n      );\r\n      \r\n      // Проверяем наличие индикатора загрузки\r\n      expect(container.querySelector('[role=\"status\"]')).toBeInTheDocument();\r\n      expect(screen.getByLabelText(\"Загрузка\")).toBeInTheDocument();\r\n      \r\n      // Проверяем, что реальные данные не отображаются\r\n      expect(screen.queryByText(\"Доходы\")).not.toBeInTheDocument();\r\n      expect(screen.queryByText(\"Расходы\")).not.toBeInTheDocument();\r\n      expect(screen.queryByText(\"Баланс\")).not.toBeInTheDocument();\r\n    });\r\n  });\r\n\r\n  describe(\"content rendering\", () => {\r\n    it(\"should render all three balance cards with correct labels\", () => {\r\n      render(<BalanceCards {...defaultProps} />);\r\n      \r\n      expect(screen.getByText(\"Доходы\")).toBeInTheDocument();\r\n      expect(screen.getByText(\"Расходы\")).toBeInTheDocument();\r\n      expect(screen.getByText(\"Баланс\")).toBeInTheDocument();\r\n    });\r\n\r\n    it(\"should format amounts correctly\", () => {\r\n      render(<BalanceCards {...defaultProps} />);\r\n      \r\n      // Проверяем, что суммы отформатированы (содержат символ рубля или числа)\r\n      expect(screen.getByText(/50.*000/)).toBeInTheDocument(); // Доходы\r\n      expect(screen.getByText(/30.*000/)).toBeInTheDocument(); // Расходы\r\n      expect(screen.getByText(/20.*000/)).toBeInTheDocument(); // Баланс\r\n    });\r\n\r\n    it(\"should apply correct color to positive balance\", () => {\r\n      const { container } = render(<BalanceCards {...defaultProps} balance={20000} />);\r\n      \r\n      // Находим элемент с балансом и проверяем класс для положительного баланса\r\n      const balanceElements = container.querySelectorAll(\".text-primary\");\r\n      expect(balanceElements.length).toBeGreaterThan(0);\r\n    });\r\n\r\n    it(\"should apply correct color to negative balance\", () => {\r\n      const { container } = render(<BalanceCards {...defaultProps} balance={-5000} />);\r\n      \r\n      // Находим элемент с балансом и проверяем класс для отрицательного баланса\r\n      const balanceElements = container.querySelectorAll(\".text-destructive\");\r\n      expect(balanceElements.length).toBeGreaterThan(0);\r\n    });\r\n  });\r\n\r\n  describe(\"responsive padding and spacing\", () => {\r\n    it(\"should have responsive padding classes on cards\", () => {\r\n      const { container } = render(<BalanceCards {...defaultProps} />);\r\n      \r\n      // Проверяем наличие адаптивных классов padding\r\n      const cards = container.querySelectorAll(\".p-2\");\r\n      expect(cards.length).toBeGreaterThan(0);\r\n      \r\n      // Проверяем наличие классов для больших экранов\r\n      const cardsWithSmPadding = container.querySelectorAll(\".sm\\\\:p-3\");\r\n      expect(cardsWithSmPadding.length).toBeGreaterThan(0);\r\n      \r\n      const cardsWithMdPadding = container.querySelectorAll(\".md\\\\:p-4\");\r\n      expect(cardsWithMdPadding.length).toBeGreaterThan(0);\r\n    });\r\n  });\r\n\r\n  describe(\"icon rendering\", () => {\r\n    it(\"should render icons with responsive sizes\", () => {\r\n      const { container } = render(<BalanceCards {...defaultProps} />);\r\n      \r\n      // Проверяем наличие иконок с адаптивными размерами\r\n      const icons = container.querySelectorAll(\".h-6, .sm\\\\:h-8, .md\\\\:h-10\");\r\n      expect(icons.length).toBeGreaterThan(0);\r\n    });\r\n  });\r\n});\r\n"],"names":["describe","defaultProps","totalIncome","totalExpense","balance","displayCurrency","it","container","render","BalanceCards","gridContainer","querySelector","expect","toBeInTheDocument","toHaveClass","screen","getByText","propsWithEmptyCurrency","byCurrency","currencyRates","queryByText","not","propsWithSingleCurrency","currency","rubBreakdown","propsWithMultipleCurrencies","USD","EUR","usdElements","getAllByText","eurElements","length","toBeGreaterThan","loading","getByLabelText","balanceElements","querySelectorAll","cards","cardsWithSmPadding","cardsWithMdPadding","icons"],"mappings":"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"}